
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Documentation for processing SATAY &#8212; SATAY pipeline at Delft :)</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/genetica_modified_neon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Status of the project" href="Introduction.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/genetica_modified_neon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SATAY pipeline at Delft :)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 current">
  <a class="reference internal" href="#">
   Documentation for processing SATAY
   <!-- omit in toc -->
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Introduction.html">
   Status of the project
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="00-Intro/data-analysis-workflow.html">
   Data analysis steps
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="00-Intro/flowchart.html">
     Flowchart of the pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="00-Intro/Installation_Guide_SATAY_Analysis_Software.html">
     Software installation guide for whole genome sequencing and transposon mapping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="00-Intro/satay_analysis_notes.html">
     All what you need to know from SATAY
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="01-bash-GUI/00-guidelines.html">
   How to use the pipeline in the docker container
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="01-bash-GUI/01-processing_workflow.html">
     Code for the bash GUI
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="02-postprocessing-scripts/00-Introduction.html">
   Python scripts
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="02-postprocessing-scripts/01-clean_bedwigfiles.html">
     Cleaning bed and wig files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02-postprocessing-scripts/02-transposonread_profileplot_genome.html">
     Transposon profile for the whole genome
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02-postprocessing-scripts/03-transposonread_profileplot.html">
     Transposon profile for a chromosome of interest
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02-postprocessing-scripts/04-scatterplot_genes.html">
     Create a scatterplot for all genes and all essential genes.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02-postprocessing-scripts/05-volcanoplot.html">
     Volcano plots to two different libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02-postprocessing-scripts/06-genomicfeatures_dataframe.html">
     Searching for genomic features  of transposition events
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-docker-doc/00-Docker-Users.html">
   Build your own docker container with ours satay pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04-Developers/00-contributing-guidelines.html">
   Contributing guidelines for developers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05-Code-of-conduct/00-code-of-conduct.html">
   Code of Conduct
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/documentation_satay.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/SATAY-LL/SATAY-jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/SATAY-LL/SATAY-jupyter-book/issues/new?title=Issue%20on%20page%20%2Fdocumentation_satay.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#file-types">
   File types
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fastq">
     fastq
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sam-bam">
     sam, bam
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bed">
     bed
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wig">
     wig
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pergene-txt-peressential-txt">
     pergene.txt, peressential.txt
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pergene-insertions-txt-peressential-insertions-txt">
     pergene_insertions.txt, peressential_insertions.txt
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#software-processing">
   Software Processing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#satay-sh">
     satay.sh
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dependencies">
       Dependencies
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#input-output">
       Input, Output
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#how-to-use">
       How to use
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tutorial">
       Tutorial
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#how-does-it-work">
       How does it work
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#notes">
       Notes
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#software-analysis">
   Software analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#python-scripts">
     python scripts
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#clean-bedwigfiles-py">
       clean_bedwigfiles.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#genomicfeatures-dataframe-py">
       genomicfeatures_dataframe.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#transposonread-profileplot-py">
       transposonread_profileplot.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#transposonread-profileplot-genome-py">
       transposonread_profileplot_genome.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#transposonread-profile-compare-py">
       TransposonRead_Profile_Compare.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scatterplot-genes-py">
       scatterplot_genes.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#volcanoplot-py">
       volcanoplot.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#create-essentialgenes-list-py">
       create_essentialgenes_list.py
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#python-modules">
     python modules
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#chromosome-and-gene-positions-py">
       chromosome_and_gene_positions.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#chromosome-names-in-files-py">
       chromosome_names_in_files.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dataframe-from-pergene-py">
       dataframe_from_pergene.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#essential-genes-names-py">
       essential_genes_names.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#gene-names-py">
       gene_names.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mapped-reads-py">
       mapped_reads.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-sgdfeatures-py">
       read_sgdfeatures.py
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#samflag-py">
       samflag.py
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-files">
     Data files
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cerevisiae-allessentialgenes-list-txt">
       Cerevisiae_AllEssentialGenes_List.txt
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#s288c-reference-sequence-r64-2-1-20150113-fsa">
       S288C_reference_sequence_R64-2-1_20150113.fsa
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sgd-features-tab">
       SGD_features.tab
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#saccharomyces-cerevisiae-r64-1-1-99-gff3">
       Saccharomyces_cerevisiae.R64-1-1.99.gff3
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#yeast-protein-names-txt">
       Yeast_Protein_Names.txt
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-tools">
     Other tools
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#igv">
       IGV
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#genome-browser">
       genome browser
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#links">
   Links
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendices">
   Appendices
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phred-table-base33">
     PHRED table (base33)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phred-table-base64">
     PHRED table (base64)
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="documentation-for-processing-satay-omit-in-toc">
<h1>Documentation for processing SATAY <!-- omit in toc --><a class="headerlink" href="#documentation-for-processing-satay-omit-in-toc" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="#introduction">Introduction</a></p></li>
<li><p><a class="reference external" href="#file-types">File types</a></p>
<ul>
<li><p><a class="reference external" href="#fastq">fastq</a></p></li>
<li><p><a class="reference external" href="#sam-bam">sam, bam</a></p></li>
<li><p><a class="reference external" href="#bed">bed</a></p></li>
<li><p><a class="reference external" href="#wig">wig</a></p></li>
<li><p><a class="reference external" href="#pergenetxt-peressentialtxt">pergene.txt, peressential.txt</a></p></li>
<li><p><a class="reference external" href="#pergene_insertionstxt-peressential_insertionstxt">pergene_insertions.txt, peressential_insertions.txt</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#software-processing">Software Processing</a></p>
<ul>
<li><p><a class="reference external" href="#sataysh">satay.sh</a></p>
<ul>
<li><p><a class="reference external" href="#dependencies">Dependencies</a></p></li>
<li><p><a class="reference external" href="#input-output">Input, Output</a></p></li>
<li><p><a class="reference external" href="#how-to-use">How to use</a></p></li>
<li><p><a class="reference external" href="#tutorial">Tutorial</a></p></li>
<li><p><a class="reference external" href="#how-does-it-work">How does it work</a></p></li>
<li><p><a class="reference external" href="#notes">Notes</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference external" href="#software-analysis">Software analysis</a></p>
<ul>
<li><p><a class="reference external" href="#python-scripts">python scripts</a></p>
<ul>
<li><p><a class="reference external" href="#clean_bedwigfilespy">clean_bedwigfiles.py</a></p></li>
<li><p><a class="reference external" href="#genomicfeatures_dataframepy">genomicfeatures_dataframe.py</a></p></li>
<li><p><a class="reference external" href="#transposonread_profileplotpy">transposonread_profileplot.py</a></p></li>
<li><p><a class="reference external" href="#transposonread_profileplot_genomepy">transposonread_profileplot_genome.py</a></p></li>
<li><p><a class="reference external" href="#transposonread_profile_comparepy">TransposonRead_Profile_Compare.py</a></p></li>
<li><p><a class="reference external" href="#scatterplot_genespy">scatterplot_genes.py</a></p></li>
<li><p><a class="reference external" href="#volcanoplotpy">volcanoplot.py</a></p></li>
<li><p><a class="reference external" href="#create_essentialgenes_listpy">create_essentialgenes_list.py</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#python-modules">python modules</a></p>
<ul>
<li><p><a class="reference external" href="#chromosome_and_gene_positionspy">chromosome_and_gene_positions.py</a></p></li>
<li><p><a class="reference external" href="#chromosome_names_in_filespy">chromosome_names_in_files.py</a></p></li>
<li><p><a class="reference external" href="#dataframe_from_pergenepy">dataframe_from_pergene.py</a></p></li>
<li><p><a class="reference external" href="#essential_genes_namespy">essential_genes_names.py</a></p></li>
<li><p><a class="reference external" href="#gene_namespy">gene_names.py</a></p></li>
<li><p><a class="reference external" href="#mapped_readspy">mapped_reads.py</a></p></li>
<li><p><a class="reference external" href="#read_sgdfeaturespy">read_sgdfeatures.py</a></p></li>
<li><p><a class="reference external" href="#samflagpy">samflag.py</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#data-files">Data files</a></p>
<ul>
<li><p><a class="reference external" href="#cerevisiae_allessentialgenes_listtxt">Cerevisiae_AllEssentialGenes_List.txt</a></p></li>
<li><p><a class="reference external" href="#s288c_reference_sequence_r64-2-1_20150113fsa">S288C_reference_sequence_R64-2-1_20150113.fsa</a></p></li>
<li><p><a class="reference external" href="#sgd_featurestab">SGD_features.tab</a></p></li>
<li><p><a class="reference external" href="#saccharomyces_cerevisiaer64-1-199gff3">Saccharomyces_cerevisiae.R64-1-1.99.gff3</a></p></li>
<li><p><a class="reference external" href="#yeast_protein_namestxt">Yeast_Protein_Names.txt</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#other-tools">Other tools</a></p>
<ul>
<li><p><a class="reference external" href="#igv">IGV</a></p></li>
<li><p><a class="reference external" href="#genome-browser">genome browser</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference external" href="#summary">Summary</a></p></li>
<li><p><a class="reference external" href="#links">Links</a></p></li>
<li><p><a class="reference external" href="#appendices">Appendices</a></p>
<ul>
<li><p><a class="reference external" href="#phred-table-base33">PHRED table (base33)</a></p></li>
<li><p><a class="reference external" href="#phred-table-base64">PHRED table (base64)</a></p></li>
</ul>
</li>
</ul>
<p>This documentation gives a complete overview for the processing of the data from SAturated Transposon Analysis in Yeast (SATAY).
It includes a short introduction to SATAY and a detailed discussion on to perform the processing from the raw sequencing data to the postprocessing and checking of the results.</p>
<p>For the processing a pipeline is created using Bash and Python.
The workflow and the python codes can be found at <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis">github.com/leilaicruz/LaanLab-SATAY-DataAnalysis</a>.
More information about satay analysis and experimental protocols can be found at the <a class="reference external" href="https://sites.google.com/site/satayusers/">satayusers website from the Kornmann lab</a> or, for more questions, visit the <a class="reference external" href="https://groups.google.com/g/satayusers">satayusers forum</a>.</p>
<blockquote>
<div><p>Date last update: 25-03-2021</p>
<p>Author: Gregory van Beek</p>
<p>Contact: Leila Inigo De la Cruz (email to: <a class="reference external" href="mailto:L&#46;M&#46;InigoDeLaCruz&#37;&#52;&#48;tudelft&#46;nl">L<span>&#46;</span>M<span>&#46;</span>InigoDeLaCruz<span>&#64;</span>tudelft<span>&#46;</span>nl</a>)</p>
<p><a class="reference external" href="https://www.tudelft.nl/en/faculty-of-applied-sciences/about-faculty/departments/bionanoscience/research/research-labs/liedewij-laan-lab/research-projects/evolvability-and-modularity-of-essential-functions-in-budding-yeast">Laanlab, Delft University of Technology</a></p>
</div></blockquote>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>SAturated Transposon Analysis in Yeast (SATAY) is method of transposon analysis optimised for usage in Saccharomyces Cerevisiae.
This method uses transposons (short DNA sequences, also known as jumping genes) which can integrate in the native yeast DNA at random locations.
A transposon insertion in a gene inhibits this gene to be translated into a functional protein, thereby inhibiting this gene function.
The advantage of this method is that it can be applied in many cells at the same time.
Because of the random nature of the transposons the insertion coverage will be more or less equal over the genome.
When enough cells are used it is expected that, considering the entire pool of cells, all genes will be inhibited by at least a few transposons.
After a transposon insertion, the cells are given the opportunity to grow and proliferate.
Cells that have a transposon inserted in an essential genomic region (and thus blocking this essential function), will proliferate only very little or not at all (i.e. these cells have a low fitness) whilst cells that have an insertion in a non-essential genomic region will generate significantly more daughter cells (i.e. these cells have a relative high fitness).
The inserted transposon DNA is then sequenced together with a part of the native yeast DNA right next to the transposon.
This allows for finding the genomic locations where the transposon is inserted by mapping the sequenced native DNA to a reference genome.
Non-essential genomic regions are expected to be sequenced more often compared to the essential regions as the cells with a non-essential insertion will have proliferated more.
Therefore, counting how often certain insertion sites are sequenced is a method for probing the fitness of the cells and therefore the essentiality of genomic regions.
For more details about the experimental approach, see the paper from Michel <a class="reference external" href="http://et.al">et.al</a>. 2017 and this website from <a class="reference external" href="https://sites.google.com/site/satayusers/">the Kornmann-lab</a>.</p>
<p>This method needs to be performed on many cells to ensure a high enough insertion coverage such that each gene is inhibited in at least a few different cells.
After transposon insertion and proliferation, the DNA from each of these cells is extracted and this is sequenced to be able to count how often each genomic region occurs.
This can yield tens of millions of sequencing reads per dataset that all need to be aligned to a reference genome.
To do this efficiently, a processing workflow is generated which inputs the raw sequencing data and outputs lists of all insertion locations together with the corresponding number of reads.
This workflow consists of quality checking, sequence trimming, alignment, indexing and transposon mapping.
This documentation explains how each of these steps are performed, how to use the workflow and discusses some python scripts for checking the data and for postprocessing analysis.</p>
</div>
<div class="section" id="file-types">
<h2>File types<a class="headerlink" href="#file-types" title="Permalink to this headline">¶</a></h2>
<p>During the processing, different file types are being used and created.
This section gives an overview of all those files, how to implement them and when to use which file.</p>
<div class="section" id="fastq">
<h3>fastq<a class="headerlink" href="#fastq" title="Permalink to this headline">¶</a></h3>
<p>This is the standard output format for sequencing data.
It contains all (raw) sequencing reads in random order including a quality string per basepair.
Each read has four lines:</p>
<ol class="simple">
<li><p>Header: Contains some basic information from the sequencing machine and a unique identifier number.</p></li>
<li><p>Sequence: The actual nucleotide sequence.</p></li>
<li><p>Dummy: Typically a ‘+’ and is there to separate the sequence line from the quality line.</p></li>
<li><p>Quality score: Indicates the quality of each basepair in the sequence line (each symbol in this line belongs to the nucleotide at the same position in the sequence line). The sequence and this quality line should always have the same length.</p></li>
</ol>
<p>The quality line is given as a phred score.
There are two versions, base33 and base64, but the base64 is outdated and hardly used anymore.
In both versions the quality score is determined by Q = -10*log10§ where P is the error probability determined during sequencing (0 &lt; P &lt; 1).
A Q-score of 0 (i.e. an error probability of P=1) is defined by ascii symbol 33 (‘!’) for base33 and by ascii symbol 64 (‘&#64;’) for base64.
A Q-score of 1 (p=0.79) is then given by ascii 34 (’ ” ‘) (for base33) etcetera.
For a full table of ascii symbols and probability scores, see the appendices of this document <a class="reference external" href="#phred-table-base33">PHRED table (base33)</a> and <a class="reference external" href="#phred-table-base64">PHRED table (base64)</a>.
Basically all fastq files that are being created on modern sequencing machines use the base33 system.</p>
<p>The nucleotide sequence typically only contains the four nucleotide letters (A, T, C and G), but when a nucleotide was not accurately determined (i.e. having a error probability higher than a certain threshold), the nucleotide is sometimes converted to the letter N, indicating that this nucleotide was not successfully sequenced.</p>
<p>Fastq files tend to be large in size (depending on how many reads are sequenced, but &gt;10Gb is normal).
Therefore these files are typically compressed in gzip format (.fastq.gz).
The pipeline can handle gzipped files by itself, so there is no need to convert it manually.</p>
<p>Example fastq file:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">&#64;NB501605:544:HLHLMBGXF:1:11101:9938:1050</span> <span class="pre">1:N:0:TGCAGCTA</span></code><br />
<code class="docutils literal notranslate"><span class="pre">TGTCAACGGTTTAGTGTTTTCTTACCCAATTGTAGAGACTATCCACAAGGACAATATTTGTGACTTATGTTATGCG</span></code><br />
<code class="docutils literal notranslate"><span class="pre">+</span></code><br />
<code class="docutils literal notranslate"><span class="pre">AAAAAEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE</span></code><br />
<code class="docutils literal notranslate"><span class="pre">&#64;NB501605:544:HLHLMBGXF:1:11101:2258:1051</span> <span class="pre">1:N:0:TACAGCTA</span></code><br />
<code class="docutils literal notranslate"><span class="pre">TGAGGCACCTATCTCAGCGATCGTATCGGTTTTCGATTACCGTATTTATCCCGTTCGTTTTCGTTGCCGCTATTT</span></code><br />
<code class="docutils literal notranslate"><span class="pre">+</span></code><br />
<code class="docutils literal notranslate"><span class="pre">AAAAAEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE6EEEEEEEE&lt;EEEAEEEEEEE/E/E/EA///</span></code><br />
<code class="docutils literal notranslate"><span class="pre">&#64;NB501605:544:HLHLMBGXF:1:11101:26723:1052</span> <span class="pre">1:N:0:TGCAGCTA</span></code><br />
<code class="docutils literal notranslate"><span class="pre">TGTCAACGGTTTAGTGTTTTCTTACCCAATTGTAGAGACTATCCACAAGGACAATATTTGTGACTTATGTTATGCG</span></code><br />
<code class="docutils literal notranslate"><span class="pre">+</span></code><br />
<code class="docutils literal notranslate"><span class="pre">AAAAAEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE</span></code></p>
</div></blockquote>
</div>
<div class="section" id="sam-bam">
<h3>sam, bam<a class="headerlink" href="#sam-bam" title="Permalink to this headline">¶</a></h3>
<p>When the reads are aligned to a reference genome, the resulting file is a Sequence Alignment Mapping (sam) file.
Every read is one line in the file and consists of at least 11 tab delimited fields that are always in the same order:</p>
<ol class="simple">
<li><p>Name of the read. This is unique for each read, but can occur multiple times in the file when a read is split up over multiple alignments at different locations.</p></li>
<li><p>Flag. Indicating properties of the read about how it was mapped (see below for more information).</p></li>
<li><p>Chromosome name to which the read was mapped.</p></li>
<li><p>Leftmost position in the chromosome to which the read was mapped.</p></li>
<li><p>Mapping quality in terms of Q-score as explained in the <a class="reference external" href="#fastq">fastq</a> section.</p></li>
<li><p>CIGAR string. Describing which nucleotides were mapped, where insertions and deletions are and where mismatches occurs. For example, <code class="docutils literal notranslate"><span class="pre">43M1I10M3D18M</span></code> means that the first 43 nucleotides match with the reference genome, the next 1 nucleotide exists in the read but not in the reference genome (insertion), then 10 matches, then 3 nucleotides that do not exist in the read but do exist in the reference genome (deletions) and finally 18 matches. For more information see <a class="reference external" href="https://www.drive5.com/usearch/manual/cigar.html">this website</a>.</p></li>
<li><p>Reference name of the mate read (when using paired end datafiles). If no mate was mapped (e.g. in case of single end data or if it was not possible to map the mate read) this is typically set to <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p></li>
<li><p>Position of the mate read. If no mate was mapped this is typically set to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p>Template length. Length of a group (i.e. mate reads or reads that are split up over multiple alignments) from the left most base position to the right most base position.</p></li>
<li><p>Nucleotide sequence.</p></li>
<li><p>Phred score of the sequence (see <a class="reference external" href="#fastq">fastq</a> section).</p></li>
</ol>
<p>Depending on the software, the sam file typically starts with a few header lines containing information regarding the alignment.
For example for BWA MEM (which is used in the pipeline), the sam file start with <code class="docutils literal notranslate"><span class="pre">&#64;SQ</span></code> lines that shows information about the names and lengths for the different chromosome and <code class="docutils literal notranslate"><span class="pre">&#64;PG</span></code> shows the user options that were set regarding the alignment software.
Note that these lines might be different when using a different alignment software.
Also, there is a whole list of optional fields that can be added to each read after the first 11 required fields.
For more information, see <a class="reference external" href="https://en.wikipedia.org/wiki/SAM_(file_format)">wikipedia</a>.</p>
<p>The flag in the sam files is a way of representing a list of properties for a read as a single integer.
There is a defined list of properties in a fixed order:</p>
<ol class="simple">
<li><p>read paired</p></li>
<li><p>read mapped in proper pair</p></li>
<li><p>read unmapped</p></li>
<li><p>mate unmapped</p></li>
<li><p>read reverse strand</p></li>
<li><p>mate reverse strand</p></li>
<li><p>first in pair</p></li>
<li><p>second in pair</p></li>
<li><p>not primary alignment</p></li>
<li><p>read fails platform/vendor quality checks</p></li>
<li><p>read is PCR or optical duplicate</p></li>
<li><p>supplementary alignment</p></li>
</ol>
<p>To determine the flag integer, a 12-bit binary number is created with zeros for the properties that are not true for a read and ones for those properties that are true for that read.
This 12-bit binary number is then converted to a decimal integer.
Note that the binary number should be read from right to left.
For example, FLAG=81 corresponds to the 12-bit binary 000001010001 which indicates the properties: ‘read paired’, ‘read reverse strand’ and ‘first in pair’.
Decoding of sam flags can be done using <a class="reference external" href="http://broadinstitute.github.io/picard/explain-flags.html">this website</a> or using <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/python_modules/samflag.py">samflag.py</a>.</p>
<p>Example sam file (note that the last read was not mapped):</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">NB501605:544:HLHLMBGXF:1:11101:25386:1198</span>&#160;&#160;&#160;&#160; <span class="pre">2064</span>&#160;&#160;&#160; <span class="pre">ref|NC_001136|</span>&#160; <span class="pre">362539</span>&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">42H34M</span>&#160; <span class="pre">*</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">GATCACTTCTTACGCTGGGTATATGAGTCGTAAT</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">EEEAEEEEEEAEEEAEEAEEEEEEEEEEEAAAAA</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">NM:i:0</span>&#160; <span class="pre">MD:Z:34</span> <span class="pre">AS:i:34</span> <span class="pre">XS:i:0</span>&#160; <span class="pre">SA:Z:ref|NC_001144|,461555,+,30S46M,0,0;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">NB501605:544:HLHLMBGXF:1:11101:20462:1198</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">16</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">ref|NC_001137|</span>&#160; <span class="pre">576415</span>&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">75M</span>&#160;&#160;&#160;&#160; <span class="pre">*</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">CTGTACATGCTGATGGTAGCGGTTCACAAAGAGCTGGATAGTGATGATGTTCCAGACGGTAGATTTGATATATTA</span>&#160;&#160;&#160;&#160; <span class="pre">EEEAEEEEEEEEEEEEEAEEAE/EEEEEEEEEEEAEEEEEE/EEEEEAEAEEEEEEEEEEEEEEEEEEEEAAAAA</span>&#160;&#160;&#160;&#160; <span class="pre">NM:i:1</span>&#160; <span class="pre">MD:Z:41C33</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">AS:i:41</span> <span class="pre">XS:i:41</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">NB501605:544:HLHLMBGXF:1:11101:15826:1199</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">4</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">*</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">*</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">*</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">ACAATATTTGTGACTTATGTTATGCG</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">EEEEEEEEEEE6EEEEEEEEEEEEEE</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">AS:i:0</span>&#160; <span class="pre">XS:i:0</span></code></p>
</div></blockquote>
<p>Sam files tend to be large in size (tens of Gb is normal).
Therefore the sam files are typically stored as compressed binary files called bam files.
Almost all downstream analysis tools (at least all tools discussed in this document) that need the alignment information accept bam files as input.
Therefore the sam files are mostly deleted after the bam file is created.
When a sam file is needed, it can always be recreated from the bam file, for example using <code class="docutils literal notranslate"><span class="pre">SAMTools</span></code> using the command <code class="docutils literal notranslate"><span class="pre">samtools</span> <span class="pre">view</span> <span class="pre">-h</span> <span class="pre">-o</span> <span class="pre">out.sam</span> <span class="pre">in.bam</span></code>.
The bam file can be sorted (creating a .sorted.bam file) where the reads are typically ordered depending on their position in the genome.
This usually also comes with an index file (a .sorted.bam.bai file) which stores some information where for example the different chromosomes start within the bam file and where specific often occuring sequences are.
Many downstream analysis tools require this file to be able to efficiently search through the bam file.</p>
</div>
<div class="section" id="bed">
<h3>bed<a class="headerlink" href="#bed" title="Permalink to this headline">¶</a></h3>
<p>A bed file is one of the outputs from the transposon mapping pipeline.
It is a standard format for storing read insertion locations and the corresponding read counts.
The file consists of a single header, typically something similar to <code class="docutils literal notranslate"><span class="pre">track</span> <span class="pre">name=[file_name]</span> <span class="pre">userscore=1</span></code>.
Every row corresponds to one insertion and has (in case of the satay analysis) the following space delimited columns:</p>
<ol class="simple">
<li><p>chromosome (e.g. <code class="docutils literal notranslate"><span class="pre">chrI</span></code> or <code class="docutils literal notranslate"><span class="pre">chrref|NC_001133|</span></code>)</p></li>
<li><p>start position of insertion</p></li>
<li><p>end position of insertion (in case of satay-analysis, this is always start position + 1)</p></li>
<li><p>dummy column (this information is not present for satay analysis, but must be there to satisfy the bed format)</p></li>
<li><p>number of reads at that insertion location</p></li>
</ol>
<p>In case of processing with <code class="docutils literal notranslate"><span class="pre">transposonmapping.py</span></code> (final step in processing pipeline) or <a class="reference external" href="https://sites.google.com/site/satayusers/complete-protocol/bioinformatics-analysis/matlab-script">the matlab code from the kornmann-lab</a>, the number of reads are given according to <code class="docutils literal notranslate"><span class="pre">(reads*20)+100</span></code>, for example 2 reads are stored as 140.</p>
<p>The bed file can be used for many downstream analysis tools, for example <a class="reference external" href="http://genome-euro.ucsc.edu/index.html">genome_browser</a>.</p>
<p>Sometimes it might occur that insertions are stored outside the chromosome (i.e. the insertion position is bigger than the length of that chromosome).
Also, reference genomes sometimes do not have the different chromosomes stored as roman numerals (for example <code class="docutils literal notranslate"><span class="pre">chrI</span></code>, <code class="docutils literal notranslate"><span class="pre">chrII</span></code>, etc.) but rather use different names (this originates from the chromosome names used in the reference genome).
These things can confuse some analysis tools, for example the <a class="reference external" href="http://genome-euro.ucsc.edu/index.html">genome_browser</a>.
To solve this, the python function <a class="reference external" href="#clean_bedwigfilespy">clean_bedwigfiles.py</a> is created.
This creates a _clean.bed file where the insertions outside the chromosome are removed and all the chromosome names are stored with their roman numerals.
See <a class="reference external" href="#clean_bedwigfilespy">clean_bedwigfiles.py</a> for more information.</p>
<p>Example bed file:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">track</span> <span class="pre">name=leila_wt_techrep_ab</span> <span class="pre">useScore=1</span></code><br />
<code class="docutils literal notranslate"><span class="pre">chrI</span> <span class="pre">86</span> <span class="pre">87</span> <span class="pre">.</span> <span class="pre">140</span></code><br />
<code class="docutils literal notranslate"><span class="pre">chrI</span> <span class="pre">89</span> <span class="pre">90</span> <span class="pre">.</span> <span class="pre">140</span></code><br />
<code class="docutils literal notranslate"><span class="pre">chrI</span> <span class="pre">100</span> <span class="pre">101</span> <span class="pre">.</span> <span class="pre">3820</span></code><br />
<code class="docutils literal notranslate"><span class="pre">chrI</span> <span class="pre">111</span> <span class="pre">112</span> <span class="pre">.</span> <span class="pre">9480</span></code></p>
</div></blockquote>
</div>
<div class="section" id="wig">
<h3>wig<a class="headerlink" href="#wig" title="Permalink to this headline">¶</a></h3>
<p>A wiggle (wig) file is another output from the transposon mapping pipeline.
It stores similar information as the bed file, but in a different format.
This file has a header typically in the form of <code class="docutils literal notranslate"><span class="pre">track</span> <span class="pre">type=wiggle_0</span> <span class="pre">maxheightPixels=60</span> <span class="pre">name=[file_name]</span></code>.
Each chromosome starts with the line <code class="docutils literal notranslate"><span class="pre">variablestep</span> <span class="pre">chrom=chr[chromosome]</span></code> where <code class="docutils literal notranslate"><span class="pre">[chromosome]</span></code> is replaced by a chromosome name, e.g. <code class="docutils literal notranslate"><span class="pre">I</span></code> or <code class="docutils literal notranslate"><span class="pre">ref|NC_001133|</span></code>.
After a variablestep line, every row corresponds with an insertion in two space delimited columns:</p>
<ol class="simple">
<li><p>insertion position</p></li>
<li><p>number of reads</p></li>
</ol>
<p>In the wig file, the read count represent the actual count (unlike the bed file where an equation is used to transform the numbers).</p>
<p>There is one difference between the bed and the wig file.
In the bed file the insertions at the same position but with a different orientation are stored as individual insertions.
In the wig file these insertions are represented as a single insertion and the corresponding read counts are added up.</p>
<p>Similar to the bed file, also in the wig insertions might occur that have an insertion position that is bigger then the length of the chromosome.
This can be solved with the <a class="reference external" href="#clean_bedwigfilespy">same python script</a> as the bed file.
The insertions that have a position outside the chromosome are removed and the chromosome names are represented as a roman numeral.</p>
<p>Example wig file:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">track</span> <span class="pre">type=wiggle_0</span> <span class="pre">maxheightPixels=60</span> <span class="pre">name=WT_merged-techrep-a_techrep-b_trimmed.sorted.bam</span></code><br />
<code class="docutils literal notranslate"><span class="pre">variablestep</span> <span class="pre">chrom=chrI</span></code><br />
<code class="docutils literal notranslate"><span class="pre">86</span> <span class="pre">2</span></code><br />
<code class="docutils literal notranslate"><span class="pre">89</span> <span class="pre">2</span></code><br />
<code class="docutils literal notranslate"><span class="pre">100</span> <span class="pre">186</span></code><br />
<code class="docutils literal notranslate"><span class="pre">111</span> <span class="pre">469</span></code></p>
</div></blockquote>
</div>
<div class="section" id="pergene-txt-peressential-txt">
<h3>pergene.txt, peressential.txt<a class="headerlink" href="#pergene-txt-peressential-txt" title="Permalink to this headline">¶</a></h3>
<p>A pergene.txt and peressential.txt file are yet another outputs from the transposon mapping pipeline.
Where bed and wig files store <em>all</em> insertions throughout the genome, these files only store the insertions in each gene or each essential gene, respectively.
Essential genes are the annotated essential genes as stated by SGD for wild type cells.
The genes are taken from the <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Yeast_Protein_Names.txt">Yeast_Protein_Names.txt</a> file, which is downloaded from <a class="reference external" href="https://www.uniprot.org/docs/yeast">uniprot</a>.
The positions of each gene are determined by a <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Saccharomyces_cerevisiae.R64-1-1.99.gff3">gff3 file</a> downloaded from SGD.
Essential genes are defined in <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Cerevisiae_AllEssentialGenes_List.txt">Cerevisiae_AllEssentialGenes.txt</a>.</p>
<p>The pergene.txt and the peressential.txt have the same format.
This consists of a header and then each row contains three tab delimited columns:</p>
<ol class="simple">
<li><p>gene name</p></li>
<li><p>total number of insertions within the gene</p></li>
<li><p>sum of all reads of those insertions</p></li>
</ol>
<p>The reads are the actual read counts.
To suppress noise, the insertion with the highest read count in a gene is removed from that gene.
Therefore, it might occur that a gene has 1 insertion, but 0 reads.</p>
<p>Note that when comparing files that include gene names there might be differences in the gene naming.
Genes have multiple names, e.g. systematic names like ‘YBR200W’ or standard names like ‘BEM1’ which can have aliases such as ‘SRO1’.
The above three names all refer to the same gene.
The <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Yeast_Protein_Names.txt">Yeast_Protein_Names.txt</a> file can be used to search for aliases when comparing gene names in different files, or the <a class="reference external" href="#genomicfeatures_dataframepy">genomicfeatures_dataframe.py</a> python script can be used which creates a pandas dataframe that includes the different gene names (this python script itself makes also use of the Yeast_Protein_Names.txt file).</p>
<p>Example of pergene.txt file:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Gene</span> <span class="pre">name</span> <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">transposons</span> <span class="pre">per</span> <span class="pre">gene</span> <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">reads</span> <span class="pre">per</span> <span class="pre">gene</span></code><br />
<code class="docutils literal notranslate"><span class="pre">YAL069W</span> <span class="pre">34</span> <span class="pre">1819</span></code><br />
<code class="docutils literal notranslate"><span class="pre">YAL068W-A</span> <span class="pre">10</span> <span class="pre">599</span></code><br />
<code class="docutils literal notranslate"><span class="pre">PAU8</span> <span class="pre">26</span> <span class="pre">1133</span></code><br />
<code class="docutils literal notranslate"><span class="pre">YAL067W-A</span> <span class="pre">12</span> <span class="pre">319</span></code></p>
</div></blockquote>
</div>
<div class="section" id="pergene-insertions-txt-peressential-insertions-txt">
<h3>pergene_insertions.txt, peressential_insertions.txt<a class="headerlink" href="#pergene-insertions-txt-peressential-insertions-txt" title="Permalink to this headline">¶</a></h3>
<p>The final two files that are created by the transposon mapping pipeline are the pergene_insertions.txt and the peressential_insertions.txt.
The files have a similar format as the pergene.txt file, but are more extensive in terms of the information per gene.
The information is taken from <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Yeast_Protein_Names.txt">Yeast_Protein_Names.txt</a>, the <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Saccharomyces_cerevisiae.R64-1-1.99.gff3">gff3 file</a> and <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Cerevisiae_AllEssentialGenes_List.txt">Cerevisiae_AllEssentialGenes.txt</a>, similar as the pergene.txt files.</p>
<p>Both the pergene_insertions.txt and the peressential_insertions.txt files have a header and then each row contains six tab delimited columns:</p>
<ol class="simple">
<li><p>gene name</p></li>
<li><p>chromosome where the gene is located</p></li>
<li><p>start position of the gene</p></li>
<li><p>end position of the gene</p></li>
<li><p>list of all insertions within the gene</p></li>
<li><p>list of all read counts in the same order as the insertion list</p></li>
</ol>
<p>This file can be useful when not only the number of insertions is important, but also the distribution of the insertions within the genes.
Similarily as the <a class="reference external" href="#pergenetxt-peressentialtxt">pergene.txt and peresential.txt file</a>, to suppress noise the insertion with the highest read count in a gene is removed from that gene.</p>
<p>This file is uniquely created in the processing workflow described below.
To create this file from a dataset processed in another workflow, store the bam file and the corresponding .bam.bai index file at the same location.
Run the transposonmapping_satay.py script with the bam file using the command <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">transposonmapping_satay.py</span> <span class="pre">[path]/[filename.bam]</span></code> (see <a class="reference external" href="#how-does-it-work">How does it work</a> for more explanation about the python script).
If the index file .bam.bai is not present, create this before running the python script.
The index file can be created using the command <code class="docutils literal notranslate"><span class="pre">sambamba-0.7.1.-linux-static</span> <span class="pre">sort</span> <span class="pre">-m</span> <span class="pre">1GB</span> <span class="pre">[path]/[filename.bam]</span></code>.
This creates a sorted.bam file and a sorted.bam.bai index file.
Run the sorted.bam file in the python script using the command <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">transposonmapping_satay.py</span> <span class="pre">[path]/[filename.sorted.bam]</span></code>.</p>
<p>Example of peressential_insertions.txt file:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Essential</span> <span class="pre">gene</span> <span class="pre">name</span> <span class="pre">chromosome</span> <span class="pre">Start</span> <span class="pre">location</span> <span class="pre">End</span> <span class="pre">location</span> <span class="pre">Insertion</span> <span class="pre">locations</span> <span class="pre">Reads</span> <span class="pre">per</span> <span class="pre">insertion</span> <span class="pre">location</span></code><br />
<code class="docutils literal notranslate"><span class="pre">EFB1</span> <span class="pre">I</span> <span class="pre">142174</span> <span class="pre">143160</span> <span class="pre">[142325,</span> <span class="pre">142886]</span> <span class="pre">[1,</span> <span class="pre">1]</span></code><br />
<code class="docutils literal notranslate"><span class="pre">MAK16</span> <span class="pre">I</span> <span class="pre">100225</span> <span class="pre">101145</span> <span class="pre">100229,</span> <span class="pre">100407,</span> <span class="pre">100422,</span> <span class="pre">100791,</span> <span class="pre">101022,</span> <span class="pre">101129]</span> <span class="pre">[4,</span> <span class="pre">1,</span> <span class="pre">5,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1]</span></code><br />
<code class="docutils literal notranslate"><span class="pre">PRE7</span> <span class="pre">II</span> <span class="pre">141247</span> <span class="pre">141972</span> <span class="pre">[141262,</span> <span class="pre">141736,</span> <span class="pre">141742,</span> <span class="pre">141895]</span> <span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1]</span></code><br />
<code class="docutils literal notranslate"><span class="pre">RPL32</span> <span class="pre">II</span> <span class="pre">45978</span> <span class="pre">46370</span> <span class="pre">[46011,</span> <span class="pre">46142,</span> <span class="pre">46240]</span> <span class="pre">[1,</span> <span class="pre">3,</span> <span class="pre">1]</span></code></p>
</div></blockquote>
</div>
</div>
<div class="section" id="software-processing">
<h2>Software Processing<a class="headerlink" href="#software-processing" title="Permalink to this headline">¶</a></h2>
<p>This section discusses the main pipeline for processing satay datasets, from the raw fastq files of the sequencing output to the bed, wig and pergene text files which can be directly used for analysis.
See the image below for a schematic overview of the pipeline with the used software tools between brackets and the file type after each processing step on the left.
Everything that is shown in green can be automatically performed in a single workflow as will be discussed in the <a class="reference external" href="#sataysh">satay section</a> below.</p>
<a class="reference internal image-reference" href="mediasatayprocessingpipeline.png"><img alt="satay_processing_pipeline" src="mediasatayprocessingpipeline.png" style="width: 500px;" /></a>
<div class="section" id="satay-sh">
<h3><a class="reference external" href="http://satay.sh">satay.sh</a><a class="headerlink" href="#satay-sh" title="Permalink to this headline">¶</a></h3>
<p><em>Note that the workflow only runs in Linux (or Mac, but this is untested) as some of its dependencies are specifically designed for Unix machines.</em></p>
<p>The main program for the data processing is called <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/satay.sh">satay.sh</a> and is a bash script which automatically calls all required software tools.</p>
<div class="section" id="dependencies">
<h4>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h4>
<p>Below is a list of dependencies.
Note the folder structure for the python scripts and modules and the data files.</p>
<ol class="simple">
<li><p>Zenity (by default installed in Linux Ubuntu 20.10)</p></li>
<li><p><a class="reference external" href="http://manpages.ubuntu.com/manpages/groovy/man1/yad.1.html">YAD</a></p></li>
<li><p><a class="reference external" href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FASTQC</a></p></li>
<li><p><a class="reference external" href="https://jgi.doe.gov/data-and-tools/bbtools/bb-tools-user-guide/">BBMap</a></p></li>
<li><p><a class="reference external" href="http://www.usadellab.org/cms/?page=trimmomatic">Trimmomatic</a></p></li>
<li><p><a class="reference external" href="http://bio-bwa.sourceforge.net/bwa.shtml">BWA</a></p></li>
<li><p><a class="reference external" href="http://www.htslib.org/">SAMTools</a></p></li>
<li><p><a class="reference external" href="https://lomereiter.github.io/sambamba/">Sambamba</a></p></li>
<li><p>Python &gt; v3.7</p>
<ol class="simple">
<li><p>numpy</p></li>
<li><p><a class="reference external" href="https://pysam.readthedocs.io/en/latest/index.html">pysam</a></p></li>
<li><p>timeit</p></li>
<li><p>python_scripts/<a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_transposonmapping/transposonmapping_satay.py">transposonmapping_satay.py</a></p></li>
<li><p>python_scripts/python_modules/<a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_transposonmapping/python_modules/chromosome_and_gene_positions.py">chromosome_and_gene_positions.py</a></p></li>
<li><p>python_scripts/python_modules/<a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_transposonmapping/python_modules/gene_names.py">gene_names.py</a></p></li>
<li><p>python_scripts/python_modules/<a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_transposonmapping/python_modules/samflag.py">samflag.py</a></p></li>
</ol>
</li>
<li><p>data_files/<a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Saccharomyces_cerevisiae.R64-1-1.99.gff3">Saccharomyces_cerevisiae.R64-1-1.99.gff3</a></p></li>
<li><p>data_files/<a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Cerevisiae_AllEssentialGenes_List.txt">Cerevisiae_AllEssentialGenes_List.txt</a></p></li>
<li><p>data_files/<a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Yeast_Protein_Names.txt">Yeast_Protein_Names.txt</a></p></li>
</ol>
</div>
<div class="section" id="input-output">
<h4>Input, Output<a class="headerlink" href="#input-output" title="Permalink to this headline">¶</a></h4>
<p>The bash script <a class="reference external" href="http://satay.sh">satay.sh</a> accepts raw fastq files, either compressed (gzip) or uncompressed, with one of the following extensions: .fastq, .fq, fastq.gz, fq.gz.
The fastq files can be either paired-end or single-end.</p>
<p>It is assumed that each data file contains one sample, so in case multiple samples are sequenced together, it might be necessary to demultiplex the fastq files.
This is not integrated in the pipeline and should be performed before the pipeline is started.</p>
<p>When the processing was completed successfully, a number of output folders are created at the same location where the input fastq file is stored. The creation of some files and folders are depending on which options are selected in <a class="reference external" href="http://satay.sh">satay.sh</a> (see below for more information about the options).
The output may include the following folders and files:</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">align_out/</span></code></p>
<ol class="simple">
<li><p><strong>.sam</strong> (depending on whether the option for deleting sam files was selected)</p></li>
<li><p><strong>.bam</strong></p></li>
<li><p><strong>.sorted.bam</strong> (depending on whether the option for <code class="docutils literal notranslate"><span class="pre">Sort</span> <span class="pre">and</span> <span class="pre">index</span> <span class="pre">bam</span> <span class="pre">files</span></code> is selected); The reads are sorted which speeds up downstream processing.</p></li>
<li><p><strong>.sorted.bam.bai</strong> (depending on whether the option for <code class="docutils literal notranslate"><span class="pre">Sort</span> <span class="pre">and</span> <span class="pre">index</span> <span class="pre">bam</span> <span class="pre">files</span></code> is selected);</p></li>
<li><p><strong>flagstatreport.txt</strong> (depending on whether <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">flagstat</span> <span class="pre">report</span> <span class="pre">is</span> <span class="pre">selected</span></code> is selected); Stores some basic information about the alignment.</p></li>
<li><p><strong>.bed</strong> (depending on whether <code class="docutils literal notranslate"><span class="pre">Transposon</span> <span class="pre">mapping</span></code> is selected)</p></li>
<li><p><strong>.wig</strong> (depending on whether <code class="docutils literal notranslate"><span class="pre">Transposon</span> <span class="pre">mapping</span></code> is selected)</p></li>
<li><p><strong>pergene.txt</strong> (depending on whether <code class="docutils literal notranslate"><span class="pre">Transposon</span> <span class="pre">mapping</span></code> is selected)</p></li>
<li><p><strong>peressential.txt</strong> (depending on whether <code class="docutils literal notranslate"><span class="pre">Transposon</span> <span class="pre">mapping</span></code> is selected)</p></li>
<li><p><strong>pergene_insertions.txt</strong> (depending on whether <code class="docutils literal notranslate"><span class="pre">Transposon</span> <span class="pre">mapping</span></code> is selected)</p></li>
<li><p><strong>peressential_insertions.txt</strong> (depending on whether <code class="docutils literal notranslate"><span class="pre">Transposon</span> <span class="pre">mapping</span></code> is selected)</p></li>
</ol>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">trimm_out/</span></code> (depending on whether the option for trimming is selected)</p>
<ol class="simple">
<li><p><strong>trimmed.fastq</strong> (depending on whether trimming is selected)</p></li>
</ol>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">fastqc/</span></code> (depending on whether the option for quality checking is selected)</p>
<ol class="simple">
<li><p><strong>.html</strong> (depending on whether Quality checking is selected); contains an a number of figures showing the quality of the data. This can be created for both raw data and/or trimmed data.</p></li>
<li><p><strong>zipped folder</strong> (depending on whether Quality checking is selected); contains the data for creating the figures in the .html file.</p></li>
</ol>
</li>
</ol>
</div>
<div class="section" id="how-to-use">
<h4>How to use<a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h4>
<p>The workflow <a class="reference external" href="http://satay.sh">satay.sh</a> only runs in Linux and is designed to be used as a commandline tool.
For a step-by-step guide, see the <a class="reference external" href="#tutorial">Tutorial</a>.</p>
<p>In the commandline, navigate to the software folder.
The workflow can be started either using commandline arguments or by using a graphical user interface (GUI).
Using the GUI is the most userfriendly approach.
Access the help text using <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">satay.sh</span> <span class="pre">--help</span></code> or <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">satay.sh</span> <span class="pre">-h</span></code> and check the current version with <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">satay.sh</span> <span class="pre">-v</span></code>.
The help text explains the different commandline arguments that can be set and briefly how to use the workflow.
The commandline arguments are the same options that are set when using the GUI, so here only the GUI is explained.</p>
<p>Start the GUI with <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">satay.sh</span></code> without any arguments.
This opens a window where the data file(s) can be selected.
Navigate to the folder containing the data file(s) and select one or two files (select only two files when using paired-end data that is not interleaved by holding the ctrl button and clicking the files).
Use the drop down window at the bottom right to select the right extension.</p>
<a class="reference internal image-reference" href="mediasatay_fileselectionwindow.png"><img alt="satay.sh_file_selection_window" src="mediasatay_fileselectionwindow.png" style="width: 700px;" /></a>
<p>After pressing <code class="docutils literal notranslate"><span class="pre">OK</span></code> a second window opens that shows all the settings with some default values that can be changed.
The first two lines indicate the file(s) that were selected in the previous window (if only one file was selected, the secondary reads file is set to <code class="docutils literal notranslate"><span class="pre">none</span></code>).
The third line is a drop-down menu to set whether to process the data as single-end (default) or paired-end reads.
The fourth line sets which trimming tool to use.
There are two trimming tools installed, BBDuk and Trimmomatic, which can be selected in this drop-down menu (default is BBDuks).
If the trimming should be skipped (and therefore the alignment is performed with the raw input data), select <code class="docutils literal notranslate"><span class="pre">donottrim</span></code> in this menu.
The fifth line sets the trimming arguments.
When trimming is skipped, what is put in this line is ignored.
Otherwise, use the arguments allowed by the selected trimming software.</p>
<p><strong>Quality checking FASTQC</strong>: A quality report of the fastq files can be created before and after the trimming.
When the dataset is processed for the first time, it is good to make a quality report of the raw data and check if there are no weird artefacts, reads with (unexpectedly) low quality and to see the overrepresented sequences.
Overrepresented sequences are normal to occur, but most of the time it is good to trim those sequences as these can influence the alignment (unless when you’re sure that the sequences belong in the reads and should not be trimmed).
For example sequences that typically occur are adapter and primer sequences.
Note that not always all sequences that need to be trimmed occur in the list of overrepresented sequences.
Therefore is also good to manually check the fastq files and try to recognize any of the adapter or primer sequences.
After trimming, create a new quality report and compare this with the raw data quality report.
For example, check if any trimmed sequences do not occur anymore in the overrepresented sequences and, when trimming was performed based on the sequencing quality, see if the overall quality of the data has improved.</p>
<p><strong>Trimming settings BBDuk</strong>: For BBDuk, a typical argument line looks like this: <code class="docutils literal notranslate"><span class="pre">ktrim=l</span> <span class="pre">k=15</span> <span class="pre">mink=10</span> <span class="pre">hdist=1</span> <span class="pre">qtrim=r</span> <span class="pre">trimq=10</span> <span class="pre">minlen=30</span></code>.
The first four options are for trimming unwanted (adapter) sequences which in BBDuk is done using k-mers (e.g. when k=3, all 3-mers for ATTGCAAT are ATT, TTG, TGC, GCA, CAA, AAT).
Any unwanted sequences that need to be trimmed (e.g. adapter, primer and transposon sequences) should be entered in the adapters file.
Clicking the <code class="docutils literal notranslate"><span class="pre">Open</span> <span class="pre">adapters</span> <span class="pre">file</span></code> opens a text file in which these unwanted sequences can be placed in fasta format.
Fasta format is similar to the fastq format, but without the last two lines (i.e. the dummy line and the quality line).
The header line of each read should start with a <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> and can contain any text (preferably no special symbols to be sure) and the next line should contain the unwanted sequence, for example:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">header</span> <span class="pre">line</span> <span class="pre">first</span> <span class="pre">unwanted</span> <span class="pre">sequence</span></code><br />
<code class="docutils literal notranslate"><span class="pre">GATC</span></code><br />
<code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">header</span> <span class="pre">line</span> <span class="pre">second</span> <span class="pre">unwanted</span> <span class="pre">seqence</span></code><br />
<code class="docutils literal notranslate"><span class="pre">CATG</span></code></p>
</div></blockquote>
<p>When all unwanted sequences are set, save the text file and close it.
The value for k is set by the <code class="docutils literal notranslate"><span class="pre">k</span></code> parameter and should not be higher than the length of the shortest unwanted sequence (e.g. if the shortest sequence that needs to be trimmed has length 10, then k &lt; 10).
The higher this number, the smaller the chances are that false positives are found when trimming.
This method, however, might skip over the last few basepairs of a read when the length of a read is not a multiple of k.
To solve for this, the <code class="docutils literal notranslate"><span class="pre">mink</span></code> option can be set which allows for shorter k-mers at the end of a read.
Therefore, <code class="docutils literal notranslate"><span class="pre">mink</span></code> &lt; <code class="docutils literal notranslate"><span class="pre">k</span></code>.
The <code class="docutils literal notranslate"><span class="pre">ktrim</span></code> option set to which side to trim when encountering an unwanted sequence (right (<code class="docutils literal notranslate"><span class="pre">r</span></code>) or left (<code class="docutils literal notranslate"><span class="pre">l</span></code>)).
The number set with <code class="docutils literal notranslate"><span class="pre">hdist</span></code> determines the number of mistakes allowed when matching the unwanted sequences with the reads.
Next are some options for quality trimming of the reads.
The <code class="docutils literal notranslate"><span class="pre">trimq</span></code> option sets the minimum Q-score that basepairs are allowed to have on average.
When the average quality of either first few or last few basepairs is lower than this threshold, those basepairs will be removed.
Whether the basepairs on the left or on the right have to be trimmed is determined by the <code class="docutils literal notranslate"><span class="pre">qtrim</span></code> parameter (either <code class="docutils literal notranslate"><span class="pre">r</span></code> or <code class="docutils literal notranslate"><span class="pre">l</span></code> or <code class="docutils literal notranslate"><span class="pre">rl</span></code> to trim everything in that read).
Finally the <code class="docutils literal notranslate"><span class="pre">minlen</span></code> parameter checks for the minimum length of a read after trimming.
When this is smaller then this threshold, the read is completely removed.
Note that the trimming can have a serious influence on the alignment and choosing good options can be important.
For more information about these and many other settings check the <a class="reference external" href="https://jgi.doe.gov/data-and-tools/bbtools/bb-tools-user-guide/bbduk-guide/">BBDuk manual</a>.</p>
<p><strong>Trimming settings Trimmomatic</strong>: Alternatively, instead of using BBDuk for the trimming, Trimmomatic can be used that requires different input arguments.
A typical input for Trimmomatic can look like this (note the capital letters): <code class="docutils literal notranslate"><span class="pre">ILLUMINACLIP:1:30:10</span> <span class="pre">LEADING:15</span> <span class="pre">TRAILING:15</span> <span class="pre">SLIDINGWINDOW:5:15</span> <span class="pre">MINLEN:10</span></code>.
The <code class="docutils literal notranslate"><span class="pre">ILLUMINACLIP</span></code> argument performs the trimming of the unwanted sequences from the adapters file.
Use the same file as for BBDuk which can be accessed using the <code class="docutils literal notranslate"><span class="pre">Open</span> <span class="pre">adapters</span> <span class="pre">file</span></code> button at the bottom of the window and also enter the reads in the same fasta format.
The first number of this argument indicates how many mismatches are allowed.
The second number is mainly for paired-end reads and determines how accurate a match should be when considering a read pair (even though this is only for paired-end reads, it is required to enter this value, but it is not important for single-end reads).
The third value sets the accuracy of a match between an unwanted sequence and the read.
The <code class="docutils literal notranslate"><span class="pre">SLIDINGWINDOW</span></code> is a quality control and uses a sliding window approach to determine the average quality of the reads within the window (length in basepairs is given by the first value) and trim the read when the quality drops below a threshold given by the second value.
The <code class="docutils literal notranslate"><span class="pre">LEADING</span></code> and <code class="docutils literal notranslate"><span class="pre">TRAILING</span></code> arguments check the quality of the basepairs at the beginning or end of the read, respectively.
If the quality is below the threshold given by the value, that basepair is trimmed.
This is repeated for all basepairs from the start of the read or at the end of the read until a basepair is found that has a quality above the threshold.
The <code class="docutils literal notranslate"><span class="pre">MINLEN</span></code> argument sets the minimum length of the read after trimming.
If the length is below the threshold, the entire read is removed.
For more information about these and many other settings check the <a class="reference external" href="http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/TrimmomaticManual_V0.32.pdf">Trimmomatic manual</a>.</p>
<p><strong>Alignment settings</strong>: The alignment settings line takes the arguments for the alignment software.
The default value is <code class="docutils literal notranslate"><span class="pre">-v</span> <span class="pre">2</span></code> which reduces the verbose level and prevents a whole lot of text to be printed during alignment, but doesn’t do anything with the way the aligner works.
The aligner determines for each read the position in the genome where it has the highest mapping score.
The read is aligned to a location and then this score is determined by giving points for each letter in the read that match with the reference genome, but adding penalty points for evey time a letter in the read doesn’t match with the genome (e.g. because of mismatches, extra letters in the read or missing letters in the read relative to the reference genome).
This score is determined for each location where the read is aligned and the read is mapped to the location with the highest score.
When the read cannot be unambiguously aligned (e.g. because all the mapping scores are too low or when there are mulitple locations that have the same highest score), the reads are aligned to a random location.
The most important parameters that can be set alters the way the mapping score is influenced by matches, mismatches, insertions, deletions etc.
Useful parameters to consider are: <code class="docutils literal notranslate"><span class="pre">-A</span></code>, <code class="docutils literal notranslate"><span class="pre">-B</span></code>, <code class="docutils literal notranslate"><span class="pre">-O</span></code>, <code class="docutils literal notranslate"><span class="pre">-E</span></code> and <code class="docutils literal notranslate"><span class="pre">-L</span></code>.
When using paired end data it is also good to think about using the parameter <code class="docutils literal notranslate"><span class="pre">-U</span></code> to change the penalty for unpaired read pairs.
For explanation about the parameters and their default values, see the <a class="reference external" href="http://bio-bwa.sourceforge.net/bwa.shtml">BWA MEM manual</a>.</p>
<p>Next are check boxes that can be set to turn on or off certain parts of the workflow.
The first two checkboxes turn on or off quality checking before and after trimming.
When <code class="docutils literal notranslate"><span class="pre">Quality</span> <span class="pre">check</span> <span class="pre">interrupt</span></code> is set, the program pauses after the raw quality checking (before the trimming) and asking if the user want to continue the processing (press <code class="docutils literal notranslate"><span class="pre">n</span></code> to stop and <code class="docutils literal notranslate"><span class="pre">y</span></code> to continue).
Stopping the program allows the user to check the quality report of the raw data.
After checking the quality report, the program can be restarted by typing <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">satay.sh</span></code> after which the program remembers the settings that were previously set (it will skip the file selection window).
Changes can be made for the trimming (including the adapters file) and alignment tools and press <code class="docutils literal notranslate"><span class="pre">OK</span></code> to continue.
This time the raw quality report will be skipped.</p>
<p>The next options determine if the sam file needs to be deleted after processing, whether the bam file needs to be sorted and indexed, if the <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_transposonmapping/transposonmapping_satay.py">transposon mapping</a> needs to be performed and if a flagstat report needs to be created (the quality report of the alignment).
Check if all the output files that are expected based on the settings are created (see the <a class="reference external" href="#input-output">Input, Output</a> section).
See the section <a class="reference external" href="#summary-and-additional-tips">Summary and additional tips</a> about how to check if the output makes sense based on the input data and the applied settings.</p>
<a class="reference internal image-reference" href="mediasatay_settingswindow.png"><img alt="satay.sh_settings_window" src="mediasatay_settingswindow.png" style="width: 700px;" /></a>
<p>The whole pipeline might take several hours to run, depending on the size of the dataset.</p>
</div>
<div class="section" id="tutorial">
<h4>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>[ ] Open the <code class="docutils literal notranslate"><span class="pre">Terminal</span></code> and navigate to the location of the <a class="reference external" href="http://satay.sh">satay.sh</a> script.</p></li>
<li><p>[ ] To start the workflow, enter <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">satay.sh</span></code>. This should open a window to select a fastq file.</p></li>
<li><p>[ ] At the bottom right, select the right extension to be able to find your file, navigate to the location of your data set and select the fastq file and press <code class="docutils literal notranslate"><span class="pre">OK</span></code>.</p></li>
<li><p>[ ] In the next window (options window) enter the parameters and options. Click <code class="docutils literal notranslate"><span class="pre">Open</span> <span class="pre">adapters</span> <span class="pre">file</span></code> to change the sequences that need to be trimmed (if any) (this file should always be in fasta format, see <a class="reference external" href="#how-to-use">How to use</a> section) and save and close the adapters file. Press <code class="docutils literal notranslate"><span class="pre">OK</span></code> to start processing.</p></li>
<li><p>[ ] If the option <code class="docutils literal notranslate"><span class="pre">quality</span> <span class="pre">check</span> <span class="pre">interrupt</span></code> was selected:</p>
<ul>
<li><p>[ ] Wait for the processing to finish the quality checking of the raw data.</p></li>
<li><p>[ ] The workflow will ask if you want to continue. Enter <code class="docutils literal notranslate"><span class="pre">y</span></code> to continue with the parameters you have set and enter <code class="docutils literal notranslate"><span class="pre">n</span></code> to stop the workflow to check the quality report of the raw data.</p></li>
<li><p>[ ] Navigate to the folder where your data file is stored and open the .html file (in the <code class="docutils literal notranslate"><span class="pre">fastqc_out</span></code> folder) and the check the quality report.</p></li>
<li><p>[ ] When finished, restart the workflow by typing <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">satay.sh</span></code>.</p></li>
<li><p>[ ] The workflow should skip the file selection window and immediately start with the processing options window where the parameters you have previously entered are set by default. Change the parameters if needed and press <code class="docutils literal notranslate"><span class="pre">OK</span></code> to continue processing.</p></li>
<li><p>[ ] The workflow should skip over the raw quality checking and continue with the processing.</p></li>
</ul>
</li>
<li><p>[ ] When processing is finished, navigate to folder where your dataset is located and check if all expected files are present (depending on what options yout have set, but at least the <code class="docutils literal notranslate"><span class="pre">align_out</span></code> folder and a log file should be present, see the <a class="reference external" href="#input-output">Input, Output</a> section).</p></li>
<li><p>[ ] Most information is stored in the <a class="reference external" href="#bed">bed</a> and <a class="reference external" href="#wig">wig</a> files. But there can be some artifacts present in these files which can be removed using <a class="reference external" href="#clean_bedwigfilespy">clean_bedwigfiles.py</a>. This is only necessary for specific downstream analysis tools like the <a class="reference external" href="#genome-browser">genome browser</a>.</p></li>
</ul>
</div>
<div class="section" id="how-does-it-work">
<h4>How does it work<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h4>
<p>When the pipeline is started after the files and options are selected, it starts with checking all the paths for the software tools and data files.
The paths to the software tools and some other files can be adjusted by opening the bash script and change the paths in the <code class="docutils literal notranslate"><span class="pre">DEFINE</span> <span class="pre">PATHS</span></code> section at the beginning of the script.
Also it checks if the options that were given by the user don’t conflict (e.g. when two data files were selected, but the option for processing the data as single-end reads in which case the second data file is ignored).
Next it defines names for all output files and folders.</p>
<p>After this the actual processing starts.
Here the full processing workflow is explained, but some parts may be skipped depending on which options are set by the user.</p>
<p>The first step is quality checking of the raw data in the fastq files using <a class="reference external" href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FASTQC</a>.
This creates a quality report in the <code class="docutils literal notranslate"><span class="pre">fastqc</span></code> folder and will take a few minutes depending on the size of the datafile.
After this first quality report the script will pause and ask the user to continue (enter <code class="docutils literal notranslate"><span class="pre">y</span></code> or <code class="docutils literal notranslate"><span class="pre">n</span></code>).
If the program is stopped, the quality report can be checked after which the program can be restarted (again with the command <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">satay.sh</span></code>).
All the previous settings will be remembered and do not have to be entered again.
But some options (e.g. trimming and alignment) can be altered if this is prefered by the user after checking the quality report.<br />
Next the trimming is started (either with <a class="reference external" href="https://jgi.doe.gov/data-and-tools/bbtools/bb-tools-user-guide/">BBMap</a> or <a class="reference external" href="http://www.usadellab.org/cms/?page=trimmomatic">Trimmomatic</a>).
If the option for paired-end data is selected, automatically these options are also selected for the trimming (e.g. <code class="docutils literal notranslate"><span class="pre">interleaved=t</span></code> for BBDuk or <code class="docutils literal notranslate"><span class="pre">PE</span></code> for Trimmomatic). Thus this should not be set manually by the user.
This step also reads the adapter sequences file to search for unwanted sequences in the reads.
The trimming can take more than half an hour to an hour (potentially even more for large datasets) and the results are stored in the <code class="docutils literal notranslate"><span class="pre">trimm_out</span></code> folder.
After the trimming, another quality report is created for the trimmed data which stored in the <code class="docutils literal notranslate"><span class="pre">fastqc</span></code> folder.<br />
Next up is the alignment by <a class="reference external" href="http://bio-bwa.sourceforge.net/bwa.shtml">BWA MEM</a>.
Just like with the trimming, arguments for indicating whether paired-end data is used (<code class="docutils literal notranslate"><span class="pre">-p</span></code>) is automatically set and therefore the user should not set these parameters manually.
The alignment can require more than one hour to complete and the results are stored in the <code class="docutils literal notranslate"><span class="pre">align_out</span></code> folder.<br />
After the alignment a quality report is created using <a class="reference external" href="http://www.htslib.org/">SAMTools</a> which checks how many reads were aligned and if there are any things to be aware of (e.g. read pairs that were not mapped as proper pairs).
The results are stored as <code class="docutils literal notranslate"><span class="pre">_flagstatreport.txt</span></code> in the <code class="docutils literal notranslate"><span class="pre">align_out</span></code> folder.
The sam file is then converted to a bam file and it is checked whether the general format and structure of the bam file is correct.
Both tasks are done using SAMTools.
Next the bam file is sorted and an index file is created using <a class="reference external" href="https://lomereiter.github.io/sambamba/">Sambamba</a>.
All the steps so far after the the alignment should not take more than a few minutes and all the results are stored in the <code class="docutils literal notranslate"><span class="pre">align_out</span></code> folder.<br />
As a final step the python script <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_transposonmapping/transposonmapping_satay.py">transposonmapping_satay.py</a> is started (see below for more details).
This creates all the files that store the information about the insertions and reads in the <code class="docutils literal notranslate"><span class="pre">align_out</span></code> folder (i.e. bed, wig, pergene.txt, peressential.txt, pergene_insertions.txt and peressential_insertions.txt).
This python script can take well over an hour to complete.<br />
After the transposon mapping the sam file is deleted and a log file is created that stores information about which file(s) has been processed, a time stamp and all the options and adapter sequences set by the user.
This log file is stored together with the input fastq file.</p>
<p>The python script transposonmapping_satay.py consist of a single python function called <code class="docutils literal notranslate"><span class="pre">transposonmapper</span></code>.
This takes a sorted bam file (which should have a bam index file present in the same folder) and potentially some additional information files.
It starts with checking if all input files are present.
Next if reads the bam file using the <code class="docutils literal notranslate"><span class="pre">pysam</span></code> function and gets some basic information about the chromosomes like the names and lengths and some statistics about the mapped reads in the bam file.<br />
Then a for-loop is started over all chromosomes and for each chromosome a for-loop is started over all reads.
For each read the samflag and the CIGAR string is taken to determine how the read was mapped (e.g. the orientation of the read).
By default the leftmost position is taken as insertion site, but if the read is reversely mapped, the length of the mapped part of the read needs to be added to the insertion position as the actual insertion happened at the rightmost position of the read.
After this correction the start position and the flags of each read are stored in arrays which are used later for creating the output files.<br />
Lists are created for all genes and all essential genes including their start and end positions in the genome.<br />
Next the chromosomes are all concatenated in one large array, so that each chromosome does not start anymore with basepair position 1, but rather continues counting from the previous chromosome (e.g. chrI starts at basepair 1 and ends at basepair 230218, then chrII starts at basepair 230219 instead of basepair 1).
This makes the next a bit easier where for each gene the insertions and reads are found that are mapped within the genes.
The last part of code consists of creating the different output files.
First the bed file is generated where the reads are saved using the equation (read_count*20)+100.
Then the pergene and peressential text files are created where the number of insertions and read count are stored together with the standard names of the genes.
The same is done for the pergene_insertions and peressential_insertions text files where all individual insertions and corresponding reads are stored which can be used later for determining the distribution of insertions within genes.
Finally the wiggle file is created where first the insertions that were mapped to the same location but with a different orientation are taken as a single insertion rather than two unique insertions.
The corresponding reads are added up and this information is stored as a wig file.</p>
</div>
<div class="section" id="notes">
<h4>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>[ ] The alignment software arguments all require to start with a dash (<code class="docutils literal notranslate"><span class="pre">-</span></code>). For some reason this sometimes gives errors and to prevent this make sure there is a space before the first argument in the <code class="docutils literal notranslate"><span class="pre">Enter</span> <span class="pre">alignment</span> <span class="pre">settings</span></code> line.</p></li>
<li><p>[ ] If the workflow unexpectedly skips over the file selection window and immediately shows the options window, it might be that a previous processing run was not correctly finished. Press <code class="docutils literal notranslate"><span class="pre">cancel</span></code> and restart the workflow. It should now start with the file selection window. (This most likely has to do with a cachefile, that is created after the <code class="docutils literal notranslate"><span class="pre">quality</span> <span class="pre">check</span> <span class="pre">interrupt</span></code>, that was not deleted. This can be deleted manually as well by removing <code class="docutils literal notranslate"><span class="pre">processing_workflow_cache.txt</span></code> at the same location where the workflow is stored).</p></li>
<li><p>[ ] When using the commandline for entering the arguments, use <code class="docutils literal notranslate"><span class="pre">Paired-end</span></code> and <code class="docutils literal notranslate"><span class="pre">Single-end</span></code> with first capital letters.</p></li>
<li><p>[ ] For all software in the pipeline, whether the data is paired-end or single-end is automatically set, so do not set options like <code class="docutils literal notranslate"><span class="pre">interleaved=t</span></code> (for BBDuk), <code class="docutils literal notranslate"><span class="pre">PE</span></code> (for Trimmomatic)
or <code class="docutils literal notranslate"><span class="pre">-p</span></code> (for BWA) in the options window of the workflow.</p></li>
<li><p>[ ] The names of the chromosomes in the reference genome that is used during alignment are not roman numerals as what is typically used for chromosomes. The output files (e.g. bed and wig files) get the chromosome names from this reference genome and since these are not roman numerals as what is generally expected, it might confuse some downstream analysis tools. There are two ways of solving this, either change the names in the reference genome (before indexing it, see the section <a class="reference external" href="#s288c_reference_sequence_r64-2-1_20150113fsa">S288C_reference_sequence_R64-2-1_20150113.fsa</a>) or by using the function <a class="reference external" href="#chromosome_names_in_filespy">chromosome_names_in_files.py</a> which can be used for converting the chromosome names found bed or wig files to roman numerals. To make the analysis tools as general as possible, the latter method is chosen with using the function and therefore the chromosome names in the reference genome are not changed. The reference genome mentioned in <a class="reference external" href="#s288c_reference_sequence_r64-2-1_20150113fsa">S288C_reference_sequence_R64-2-1_20150113.fsa</a> uses the following chromosome names:</p>
<ul>
<li><p>I: ref|NC_001133|</p></li>
<li><p>II: ref|NC_001134|</p></li>
<li><p>III: ref|NC_001135|</p></li>
<li><p>IV: ref|NC_001136|</p></li>
<li><p>V: ref|NC_001137|</p></li>
<li><p>VI: ref|NC_001138|</p></li>
<li><p>VII: ref|NC_001139|</p></li>
<li><p>VIII: ref|NC_001140|</p></li>
<li><p>IX: ref|NC_001141|</p></li>
<li><p>X: ref|NC_001142|</p></li>
<li><p>XI: ref|NC_001143|</p></li>
<li><p>XII: ref|NC_001144|</p></li>
<li><p>XIII: ref|NC_001145|</p></li>
<li><p>XIV: ref|NC_001146|</p></li>
<li><p>XV: ref|NC_001147|</p></li>
<li><p>XVI: ref|NC_001148|</p></li>
<li><p>Mito: ref|NC_001224|</p></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="section" id="software-analysis">
<h2>Software analysis<a class="headerlink" href="#software-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="python-scripts">
<h3>python scripts<a class="headerlink" href="#python-scripts" title="Permalink to this headline">¶</a></h3>
<p>The software discussed in the <a class="reference external" href="#software-processing">previous section</a> is solely for the processing of the data.
The codes that are discussed here are for the postprocessing analysis.
These are all python scripts that are not depended on Linux (they run and are tested in Windows) and only use rather standard python package like numpy, matplotlib, pandas, seaborn and scipy.
The python version used for creating and testing is Python v3.8.5.</p>
<p>The order in which to run the programs shouldn’t matter as these scripts are all independed of each other except for genomicfeatures_dataframe.py which is sometimes called by other scripts.
However, most scripts are depending on one or more <a class="reference external" href="#python-modules">python modules</a>, which are all expected to be located in a python_modules folder inside the folder where the python scripts are located (see <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/tree/master/python_scripts">github</a> for an example how this is organized).
Also, many python scripts and modules are depending on <a class="reference external" href="#data-files">data files</a> stored in a folder called data_files located in the same folder of the python_scripts folder.
The input for most scripts and modules are the output files of the processing, see the <a class="reference external" href="#input-output">Input, Output</a> section.</p>
<p>This is a typical order which can be used of the scripts described below:</p>
<ol class="simple">
<li><p>clean_bedwigfiles.py (to clean the bed and wig files).</p></li>
<li><p>transposonread_profileplot_genome.py (to check the insertion and read distribution throughout the genome).</p></li>
<li><p>transposonread_profileplot.py (to check the insertions and read distribution per chromosome in more detail).</p></li>
<li><p>scatterplot_genes.py (to compare the distribution for the number of insertions per gene and per essential gene).</p></li>
<li><p><a class="reference external" href="http://volcanoplot.py">volcanoplot.py</a> (only when comparing multiple datasets with different genetic backgrounds to see which genes have a significant change in insertion and read counts).</p></li>
</ol>
<p>Most of the python scripts consists of one or more functions.
These functions are called at the end of each script after the line <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__':</span></code>.
The user input for these functions are stated at the beginning of the script in the <code class="docutils literal notranslate"><span class="pre">#INPUT</span></code> section.
All packages where the scripts are depending on are called at the beginning of the script.
The scripts also contain a help text about how to use the functions.</p>
<div class="section" id="clean-bedwigfiles-py">
<h4>clean_bedwigfiles.py<a class="headerlink" href="#clean-bedwigfiles-py" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><strong>Main tasks</strong></p></li>
</ul>
<p>Remove reads mapped outside chromosomes in .bed and .wig files, clean up those files and create custom header and optionally create additional bed and wig files containing information for a single chromosome.</p>
<ul class="simple">
<li><p><strong>Dependencies</strong></p></li>
</ul>
<p><a class="reference external" href="#chromosome_and_gene_positionspy">chromosome_and_gene_positions.py</a><br />
<a class="reference external" href="#chromosome_names_in_filespy">chromosome_names_in_files.py</a></p>
<ul class="simple">
<li><p><strong>How and when to use</strong></p></li>
</ul>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/clean_bedwigfiles.py">This script</a> consists of a single function called <code class="docutils literal notranslate"><span class="pre">strip_redundant_ins</span></code> with the following arguments:</p>
<p><code class="docutils literal notranslate"><span class="pre">filepath=[path]</span></code> (required)<br />
<code class="docutils literal notranslate"><span class="pre">custom_header=[text]</span></code><br />
<code class="docutils literal notranslate"><span class="pre">split_chromosomes=True||False</span></code></p>
<p>Input of the function is a path to a bed or wig file (required).
Optionally a string for the custom header can be added to the input that changes the header line of each file.
By default the name in the header is the same name as the original datafile (fastq file), but this can be a long and unclear name.
Therefore, it can be useful to change this when the bed or wig files are used for other analysis tools that use the name stated in the header, for example the <a class="reference external" href="#genome-browser">genome browser</a>.
If no custom header is provided, the original header is used.
Also the names of the chromosomes are the names that are used in the reference genome (see <a class="reference external" href="#notes">satay.sh notes</a> for more explanation).
In this function these names are replaced by roman numerals which is more commonly used.</p>
<p>Sometimes insertions can be mapped outside chromosomes (i.e. the insertion position of a read is larger than the length of the chromosome it is mapped to).
The reason for this result is unclear, but is likely to be the result of either the alignment or transposon mapping in the processing workflow.
It can cause issues with downstream analysis tools and therefore this function removes those reads.
The removed reads are shown in the terminal where the python script runs.
Check that only few reads are removed.</p>
<p>Finally, when the <code class="docutils literal notranslate"><span class="pre">split_chromosomes</span></code> argument is set to True, separate files are created with the contents of each individual chromosome in bed or wig format.
These files are stored in a dedicated folder with the same name as the bed or wig file with the extension <code class="docutils literal notranslate"><span class="pre">_chromosomesplit</span></code>.
In this folder the files are stored, again with the same name as the input bed or wig file with roman numeral as extension indicating from which chromosome it stores the information.</p>
<ul class="simple">
<li><p><strong>Output</strong></p></li>
</ul>
<p>A new file is created at the same location as the input file with <code class="docutils literal notranslate"><span class="pre">_clean</span></code> added to the name and with the same extension as the input name (e.g. input WT.bed results in WT_clean.bed being created).
This contains the same information as the original bed or wig file, but with roman numerals for the chromosome names and the reads outside the chromosomes removed.
Optionally the header is changed when this was provided by the user.
A dedicated folder can be created where multiple files are stored, each containing the information for a specific chromosome.</p>
<ul class="simple">
<li><p><strong>Notes</strong></p></li>
<li><p>[ ] In the wig file, each  chromosome starts with a VariableStep line. By default this is written with capital V and S, but some tools may have issues with the capital letters. Therefore this script also converts everything to lowercase letters (i.e. variablestep).</p></li>
</ul>
</div>
<div class="section" id="genomicfeatures-dataframe-py">
<h4>genomicfeatures_dataframe.py<a class="headerlink" href="#genomicfeatures-dataframe-py" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><strong>Main tasks</strong></p></li>
</ul>
<p>Create a pandas dataframe that stores information for a specific chromosome including all genomic features, positions and the number of insertions and reads within those features for an entire chromosome or specific genomic region.
Optionally it can create a barplot with the number of insertions or reads within each feature.</p>
<ul class="simple">
<li><p><strong>Dependencies</strong></p></li>
</ul>
<p>pandas<br />
matplotlib<br />
<a class="reference external" href="#chromosome_and_gene_positionspy">chromosome_and_gene_positions.py</a><br />
<a class="reference external" href="#chromosome_names_in_filespy">chromosome_names_in_files.py</a><br />
<a class="reference external" href="#gene_namespy">gene_names.py</a><br />
<a class="reference external" href="#read_sgdfeaturespy">read_sgdfeatures.py</a></p>
<p><a class="reference external" href="#cerevisiae_allessentialgenes_listtxt">Cerevisiae_AllEssentialGenes_List.txt</a><br />
<a class="reference external" href="#sgd_featurestab">SGD_features.tab</a><br />
<a class="reference external" href="#saccharomyces_cerevisiaer64-1-199gff3">Saccharomyces_cerevisiae.R64-1-1.99.gff3</a><br />
<a class="reference external" href="#yeast_protein_namestxt">Yeast_Protein_Names.txt</a></p>
<ul class="simple">
<li><p><strong>How and when to use</strong></p></li>
</ul>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/genomicfeatures_dataframe.py">This script</a> consists of two functions, <code class="docutils literal notranslate"><span class="pre">dna_features</span></code> and <code class="docutils literal notranslate"><span class="pre">feature_position</span></code>.
The function <code class="docutils literal notranslate"><span class="pre">dna_features</span></code> is the main function that takes user inputs and this function calls the function <code class="docutils literal notranslate"><span class="pre">feature_position</span></code> which is not intended to be used directly.
The function <code class="docutils literal notranslate"><span class="pre">dna_features</span></code> takes the following arguments:</p>
<p><code class="docutils literal notranslate"><span class="pre">region=[int]||[string]||[list]</span></code> (required)<br />
<code class="docutils literal notranslate"><span class="pre">wig_file=[path]</span></code> (required)<br />
<code class="docutils literal notranslate"><span class="pre">pergene_insertions_file=[path]</span></code> (required)<br />
<code class="docutils literal notranslate"><span class="pre">variable=&quot;reads&quot;||&quot;insertions&quot;</span></code><br />
<code class="docutils literal notranslate"><span class="pre">plotting=True||False</span></code><br />
<code class="docutils literal notranslate"><span class="pre">savefigure=True||False</span></code><br />
<code class="docutils literal notranslate"><span class="pre">verbose=True||False</span></code></p>
<p>The script takes a wig file and a pergene_insertions_file and a genomic region.
This genomic region can be:</p>
<ul class="simple">
<li><p>chromosome number (either roman numeral or integer between 1 and 16)</p></li>
<li><p>a list with three arguments: first a number defining the chromosome (again either roman numeral or integer between 1 and 16) second an integer defining the start basepair and third an integer defining an end basepair (e.g. [“I”, 10000, 20000] to get the region between basepair 10000 and 20000 on chromosome 1)</p></li>
<li><p>a gene name (e.g. “CDC42”) which will automatically get the corresponding chromosome and basepair position</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">plotting</span></code> argument (True or False) defines whether to create a barplot.
The <code class="docutils literal notranslate"><span class="pre">variable</span></code> argument determines what to plot, either reads or insertions and the <code class="docutils literal notranslate"><span class="pre">savefigure</span></code> whether to automatically save the figure at the same location as where this script is stored.
Finally the <code class="docutils literal notranslate"><span class="pre">verbose</span></code> determines if any printing output should be given (this is mostly useful for when calling this script from other python scripts).</p>
<p>This scripts does not only look at genes, but also at other genomic regions like telomeres, centromeres, rna genes etc.
All these features are stored in one dataframe called <code class="docutils literal notranslate"><span class="pre">dna_df2</span></code> that includes naming and positional information about the features and the insertion and read counts (see output).
The dataframe will always be created for one entire chromosome (regardless if a basepair region or gene name was entered in the <code class="docutils literal notranslate"><span class="pre">region</span></code> argument).
When the plotting is set to the True, it will also create a barplot for the same chromosome within the region that is defined in the <code class="docutils literal notranslate"><span class="pre">region</span></code> variable.
The plot distinguishes between nonessential genes, essential genes, other genomic features (e.g. telomeres, centromeres etc.) and noncoding dna.
The width of the bars is determined by the length of the genomic feature and the height represents either the number of reads or insertions (depending what is defined in <code class="docutils literal notranslate"><span class="pre">variable</span></code>).</p>
<p>This function can be useful for other python functions when information is required about the positions, insertions and read counts of various genomic features.
The full list of genomic features that is regarded in the dataframe is mentioned in <a class="reference external" href="#read_sgdfeaturespy">read_sgdfeatures.py</a>.</p>
<ul class="simple">
<li><p><strong>Output</strong></p></li>
</ul>
<p>The main output is the <code class="docutils literal notranslate"><span class="pre">dna_df2</span></code> dataframe in which each row represents a genomic feature and has the following columns:</p>
<ul class="simple">
<li><p>Feature name</p></li>
<li><p>Feature standard name</p></li>
<li><p>Feature aliases (different names for the same feature, mainly for genes)</p></li>
<li><p>Essentialilty (only for genes)</p></li>
<li><p>Chromosome where feature is located</p></li>
<li><p>Position in terms in basepairs</p></li>
<li><p>Length of feature in terms of basepairs</p></li>
<li><p>Number of insertions in feature</p></li>
<li><p>Number of insertions in truncated feature (only for genes, the insertions in the first and last 100bp are ignored, see below)</p></li>
<li><p>Sum of reads in feature</p></li>
<li><p>Sum of reads in truncated feature (only for genes, where the reads in the first and last 100bp are ignored)</p></li>
<li><p>Number of reads per insertion</p></li>
<li><p>Number of reads per insertion (only for genes, where the insertions and reads in the first and last 100bp are ignored)</p></li>
</ul>
<p>The truncated feature columns ignores basepairs at the beginning and end of a gene.
This can be useful as it is mentioned that insertions located at the beginning or end of a gene can result in a protein that is still functional (although truncated) (e.g. see Michel <a class="reference external" href="http://et.al">et.al</a>. 2017) (see Notes for a further discussion about how this is defined).</p>
<a class="reference internal image-reference" href="mediagenomicfeatures_dataframe_dnadf2.png"><img alt="genomicfeature_dataframe_dnadf2" src="mediagenomicfeatures_dataframe_dnadf2.png" style="width: 700px;" /></a>
<p>When plotting is set to True, a barplot is created where the width of the bars correspond to the width of the feature the bar is representing.
This can be automatically saved at the location where the python script is stored.
The plot is created for an entire chromosome, or it can be created for a specific region, for example when a list is provided in the <code class="docutils literal notranslate"><span class="pre">region</span></code> argument or when a gene name is given.</p>
<a class="reference internal image-reference" href="mediagenomicfeatures_dataframe_barplot.png"><img alt="genomicfeature_dataframe_dnadf2" src="mediagenomicfeatures_dataframe_barplot.png" style="width: 700px;" /></a>
<ul class="simple">
<li><p><strong>Notes</strong></p></li>
<li><p>[ ] The definition for a truncated gene is currently that the first and last 100bp are ignored. This is not completely fair as this is much more stringent for short genes compared to long genes. Alternatively this can be changed to a percentage, for example ignoring the first and last 5 percent of a gene, but this can create large regions in long genes. There is no option to set this directly in the script, but if this needs to be changed, search the script for the following line: <code class="docutils literal notranslate"><span class="pre">#TRUNCATED</span> <span class="pre">GENE</span> <span class="pre">DEFINITION</span></code>. This should give the <code class="docutils literal notranslate"><span class="pre">N10percent</span></code> variable that controls the definition of a truncated gene.</p></li>
<li><p>[ ] The barplot currently only takes reads or insertions, but it might be useful to include  reads per insertions as well.</p></li>
<li><p>[ ] Sometimes it can happen that two genomic regions can overlap. When this happens, the dataframe shows a feature, in the next row another feature and then the next row from that it continues with the first feature (e.g. row1; geneA, row2; overlapping feature, row3; geneA). This issue is not automatically solved yet, but best is to, whenever you find a feature, to search if that feature also exists a couple of rows further on. If yes, sum all rows between the first and last occurance of your gene (e.g. in the example above for geneA, sum the values from row1, row2 and row3).</p></li>
<li><p>[ ] A stripped down version of this script exists as a python module called <a class="reference external" href="#dataframe_from_pergenepy">dataframe_from_pergene.py</a>.</p></li>
</ul>
</div>
<div class="section" id="transposonread-profileplot-py">
<h4>transposonread_profileplot.py<a class="headerlink" href="#transposonread-profileplot-py" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><strong>Main tasks</strong></p></li>
</ul>
<p>Create a barplot to show the read or insertion count for one chromosome and indicate the location of the genes which are colorcoded based on their essentiality.</p>
<ul class="simple">
<li><p><strong>Dependencies</strong></p></li>
</ul>
<p>numpy<br />
matplotlib<br />
<a class="reference external" href="#chromosome_and_gene_positionspy">chromosome_and_gene_positions.py</a><br />
<a class="reference external" href="#chromosome_names_in_filespy">chromosome_names_in_files.py</a><br />
<a class="reference external" href="#essential_genes_namespy">essential_genes_names.py</a></p>
<ul class="simple">
<li><p><strong>How and when to use</strong></p></li>
</ul>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/transposonread_profileplot.py">This code</a> consists of a single function <code class="docutils literal notranslate"><span class="pre">profile_plot</span></code> which takes the following arguments:</p>
<p><code class="docutils literal notranslate"><span class="pre">bed_file=[path]</span></code> (required)<br />
<code class="docutils literal notranslate"><span class="pre">variable=&quot;transposons&quot;||&quot;reads&quot;</span></code><br />
<code class="docutils literal notranslate"><span class="pre">chrom=[roman</span> <span class="pre">numeral]</span></code><br />
<code class="docutils literal notranslate"><span class="pre">bar_width=[int]</span></code><br />
<code class="docutils literal notranslate"><span class="pre">savefig=True||False</span></code></p>
<p>The <code class="docutils literal notranslate"><span class="pre">variable</span></code> arguments determines whether to plot the number of transposons or the number of reads for a chromosome defined in <code class="docutils literal notranslate"><span class="pre">chrom</span></code>.
The <code class="docutils literal notranslate"><span class="pre">bar_width</span></code> argument defines the width of the bars (in basepairs).
All insertions or reads within a bar are added up.
Wider bars makes the script significantly faster, but this might cause regions with low abundance less visible where the smaller bars provide more detailed information.
By default the width of the bars are chosen as the length of the chromosome divided by 800.</p>
<p>Optionally, the figure can be automatically saved at the same location where the bed file is stored with the <code class="docutils literal notranslate"><span class="pre">savefig</span></code> argument.
The name given to the figure is the name of the bed file with the extension _[variable]plot_chrom[chrom].png (where the names between the brackets are replaced with their respective names from the input).</p>
<ul class="simple">
<li><p><strong>Output</strong></p></li>
</ul>
<p>A barplot is created which shows the transposon or read count throughout the genome together with a strip that is colorcoded at the location of genes based on their essentiality to compare the insertion or read abundance relative to the location of the genes.</p>
<a class="reference internal image-reference" href="mediatransposonread_profileplot_readprofile.png"><img alt="transposonread_profileplot_readprofile" src="mediatransposonread_profileplot_readprofile.png" style="width: 700px;" /></a>
<ul class="simple">
<li><p><strong>Notes</strong></p></li>
<li><p>[ ]</p></li>
</ul>
</div>
<div class="section" id="transposonread-profileplot-genome-py">
<h4>transposonread_profileplot_genome.py<a class="headerlink" href="#transposonread-profileplot-genome-py" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><strong>Main tasks</strong></p></li>
</ul>
<p>Create a barplot to show the read or insertion count for the whole genome and indicate the location of the genes which are colorcoded based on their essentiality.</p>
<ul class="simple">
<li><p><strong>Dependencies</strong></p></li>
</ul>
<p>numpy<br />
matplotlib<br />
<a class="reference external" href="#chromosome_and_gene_positionspy">chromosome_and_gene_positions.py</a><br />
<a class="reference external" href="#chromosome_names_in_filespy">chromosome_names_in_files.py</a><br />
<a class="reference external" href="#essential_genes_namespy">essential_genes_names.py</a></p>
<ul class="simple">
<li><p><strong>How and when to use</strong></p></li>
</ul>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/transposonread_profileplot_genome.py">This code</a> consists of a single function <code class="docutils literal notranslate"><span class="pre">profile_genome</span></code> which takes the following arguments:</p>
<p><code class="docutils literal notranslate"><span class="pre">bed_file=[path]</span></code> (required)<br />
<code class="docutils literal notranslate"><span class="pre">variable=&quot;transposons&quot;||&quot;reads&quot;</span></code><br />
<code class="docutils literal notranslate"><span class="pre">bar_width=[int]</span></code><br />
<code class="docutils literal notranslate"><span class="pre">savefig=True||False</span></code></p>
<p>This code is very similar to <a class="reference external" href="#transposonread_profileplotpy">transposonread_profileplot.py</a>, instead this code creates a barplot for the entire genome.
The <code class="docutils literal notranslate"><span class="pre">variable</span></code> arguments defines whether the transposon or read count is plotted and the <code class="docutils literal notranslate"><span class="pre">bar_width</span></code> sets the number of basepairs that is considered in each bin.
All the reads or insertions are summed within each bin.
A lower value allows for more details to be visible, but can take more time to plot.
Higher values may obscure areas of low abundance.
Default setting is length of the genome divided by 1000 (i.e. aprroximately 1200bp per bin).</p>
<p>Optionally the figures might be automatically saved by setting <code class="docutils literal notranslate"><span class="pre">savefig</span></code> to True where the figure is saved at the same location and name as the bed file with the extension [variable]plot_genome.png (where [variable] is replaced with whatever is set in the <code class="docutils literal notranslate"><span class="pre">variable</span></code> argument).</p>
<ul class="simple">
<li><p><strong>Output</strong></p></li>
</ul>
<p>A barplot is created that shows the tranposon or read abundance for the genome together with the location of the genes that are colorcoded based on their essentiality.</p>
<a class="reference internal image-reference" href="mediatransposonread_genomeplot_transposonprofile.png"><img alt="transposonread_genomeplot_transposonprofile" src="mediatransposonread_genomeplot_transposonprofile.png" style="width: 700px;" /></a>
<ul class="simple">
<li><p><strong>Notes</strong></p></li>
<li><p>[ ] Sometimes the colorcoding of the strip below the figure changes when the figure is saved. This is not due to the code (which always loads the same gene positions from the same files), but this likely due to how the figure was saved by the used editor (tested with Spyder4). Probably the resolution is not high enough to show the fine details in the strip.</p></li>
</ul>
</div>
<div class="section" id="transposonread-profile-compare-py">
<h4>TransposonRead_Profile_Compare.py<a class="headerlink" href="#transposonread-profile-compare-py" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><strong>Main tasks</strong></p></li>
</ul>
<p>Create a barplot for two datasets, either with transposon counts or reads counts, and visualize the differences between the two datasets.</p>
<ul class="simple">
<li><p><strong>Dependencies</strong></p></li>
</ul>
<p>numpy<br />
matplotlib<br />
<a class="reference external" href="#chromosome_and_gene_positionspy">chromosome_and_gene_positions.py</a><br />
<a class="reference external" href="#chromosome_names_in_filespy">chromosome_names_in_files.py</a><br />
<a class="reference external" href="#essential_genes_namespy">essential_genes_names.py</a><br />
<a class="reference external" href="#gene_namespy">gene_names.py</a></p>
<p><a class="reference external" href="#saccharomyces_cerevisiaer64-1-199gff3">Saccharomyces_cerevisiae.R64-1-1.99.gff3</a><br />
<a class="reference external" href="#yeast_protein_namestxt">Yeast_Protein_Names.txt</a><br />
<a class="reference external" href="#cerevisiae_allessentialgenes_listtxt">Cerevisiae_AllEssentialGenes_List.txt</a></p>
<ul class="simple">
<li><p><strong>How and when to use</strong></p></li>
</ul>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/transposonread_profile_compare.py">This code</a> consists of a single function called <code class="docutils literal notranslate"><span class="pre">compareplot</span></code>.
This function takes the following inputs:</p>
<p><code class="docutils literal notranslate"><span class="pre">bed_files=list</span> <span class="pre">of</span> <span class="pre">2</span> <span class="pre">paths</span></code> (required)<br />
<code class="docutils literal notranslate"><span class="pre">variable=&quot;insertions&quot;||&quot;reads&quot;</span></code><br />
<code class="docutils literal notranslate"><span class="pre">chromosome=roman</span> <span class="pre">numeral||list</span> <span class="pre">of</span> <span class="pre">roman</span> <span class="pre">numerals</span></code><br />
<code class="docutils literal notranslate"><span class="pre">set_barwidth=integer</span></code><br />
<code class="docutils literal notranslate"><span class="pre">set_logscale=True||False</span></code><br />
<code class="docutils literal notranslate"><span class="pre">savefig=True||False</span></code></p>
<p>There are two bed files compared and therefore the <code class="docutils literal notranslate"><span class="pre">bed_files</span></code> arguments takes a list containing the paths of two bed files.
This first one is called <code class="docutils literal notranslate"><span class="pre">set1</span></code> (shown in the top graph in the figure) and the second is called <code class="docutils literal notranslate"><span class="pre">set2</span></code> in the output figure (shown in the bottom graph in the figure) and the difference is determined by set1-set2.
The plot can be created for both transposon counts (<code class="docutils literal notranslate"><span class="pre">variable=&quot;insertions&quot;</span></code>) or for read counts (<code class="docutils literal notranslate"><span class="pre">variable=&quot;reads&quot;</span></code>).
The <code class="docutils literal notranslate"><span class="pre">chromosome</span></code> takes a roman numeral for the chromosome that needs to be analyzed.
Optionally a list of roman numerals can be given that will be analyzed all at once.
This creates a number of figures equal to the number of chromosomes entered in the list.
The <code class="docutils literal notranslate"><span class="pre">bar_width</span></code> can be set to determine the width of the bars in basepairs (default is length of the chromosome divided by 500).
The differences between datasets can be small relative to the number of counts, especially when comparing reads.
To make the differences better visible, the y axis can be set in log scale using the <code class="docutils literal notranslate"><span class="pre">set_logscale</span></code> argument to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
This visually enhances the differences, but can give a distorded view as the differences appear much bigger than they actually are.
Finally, the <code class="docutils literal notranslate"><span class="pre">savefig</span></code> argument determines whether the figure needs to be saved.
If a figure is saved, it won’t be shown and it will be stored at the location of the bed file that occurs first in the <code class="docutils literal notranslate"><span class="pre">bed_files</span></code> list.
The name that is given to the saved figures is the name of the first occuring bed file with the extension <code class="docutils literal notranslate"><span class="pre">_compareplot_chrom[romannumeral].png</span></code> where [romannumeral] is replaced by the chromosome number.
The background of the figure is colorcoded at the location where the genes are located where red are the non-essential genes and green are the annotated essential genes in wild type.</p>
<p>This figure can be useful to create after processing the same dataset multiple times with different settings (e.g. for the trimming and alignment).</p>
<ul class="simple">
<li><p><strong>Output</strong></p></li>
</ul>
<p>Two barplots are created plotted on top of each other where black bars show the insertion or read count for either of two datasets.
Note that the y axis of the bottom graph is inverted.
The overlapping blue bars indicate the absolute difference between the datasets where the bottom graph (set2) is substracted from the top graph (set1).
The colorcoded background indicate the location of essential and non-essential genes.
On top the graph the names of the essential genes are plotted.</p>
<a class="reference internal image-reference" href="mediatransposonread_compareplot_transposonprofile.png"><img alt="transposonread_compareplot_transposonprofile" src="mediatransposonread_compareplot_transposonprofile.png" style="width: 700px;" /></a>
<ul class="simple">
<li><p><strong>Notes</strong></p></li>
<li><p>[ ] When automatically saving the figure the names of the compared files are not stored, so it is good to (manually) create a file stating what is compared.</p></li>
</ul>
</div>
<div class="section" id="scatterplot-genes-py">
<h4>scatterplot_genes.py<a class="headerlink" href="#scatterplot-genes-py" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><strong>Main tasks</strong></p></li>
</ul>
<p>Create a sorted scatterplot that shows the number of reads per insertion per gene for both annotated essential and non-essential genes.
This is plotted together with a histogram of the reads per insertion per gene to indicate potential differences in the distribution between essential and non-essential genes.</p>
<ul class="simple">
<li><p><strong>Dependencies</strong></p></li>
</ul>
<p>numpy<br />
matplotlib<br />
seaborn<br />
pandas<br />
<a class="reference external" href="#essential_genes_namespy">essential_genes_names.py</a></p>
<p><a class="reference external" href="#cerevisiae_allessentialgenes_listtxt">Cerevisiae_EssentialGenes_List_1.txt and Cerevisiae_EssentialGenes_List_2.txt</a></p>
<ul class="simple">
<li><p><strong>How and when to use</strong></p></li>
</ul>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/scatterplot_genes.py">This code</a> consists of a single function called <code class="docutils literal notranslate"><span class="pre">scatterplot</span></code> that takes a single argument for the path of the pergene.txt file.
From this file it takes, for each gene, the number of insertions and the number of reads and with this it calculates the number of reads per insertion.
This is stored in a dataframe together with the essentiality (True or False) for each gene which is returned as output.</p>
<p>The genes are sorted based on their reads per insertion value and therefore the genes with the lowest reads per insertion are on the left of the graph and the genes with the highest values are always on the right of the graph.
The genes are colorcoded based on their essentiality.</p>
<p>Next to the sorted scatterplot a histogram is shown for the y-axis of the scatterplot that shows the distribution of the reads per insertion for the essential genes and the non-essential genes in two overlapping histograms.</p>
<ul class="simple">
<li><p><strong>Output</strong></p></li>
</ul>
<p>The main output is a sorted scatterplot (i.e. a hockeystickplot) together with a histogram showing the distribution of the reads per insertion for essential and non-essential genes.</p>
<p>Next to the plots it returns a dataframe with data from the pergene.txt file together with the essentiality of each gene.</p>
<a class="reference internal image-reference" href="mediascatterplot_genes_plot.png"><img alt="genomicfeature_dataframe_dnadf2" src="mediascatterplot_genes_plot.png" style="width: 700px;" /></a>
<ul class="simple">
<li><p><strong>Notes</strong></p></li>
<li><p>[ ] This code is relatively bare bones and could be extended with statistics to more thoroughly compare the essential and the non-essential gene distributions.</p></li>
</ul>
</div>
<div class="section" id="volcanoplot-py">
<h4><a class="reference external" href="http://volcanoplot.py">volcanoplot.py</a><a class="headerlink" href="#volcanoplot-py" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><strong>Main tasks</strong></p></li>
</ul>
<p>Creates a a volcano plot that shows the fold change per gene between two datasets and the significance of this fold change.</p>
<ul class="simple">
<li><p><strong>Dependencies</strong></p></li>
</ul>
<p>scipy<br />
matplotlib<br />
<a class="reference external" href="#dataframe_from_pergenepy">dataframe_from_pergene.py</a></p>
<ul class="simple">
<li><p><strong>How and when to use</strong></p></li>
</ul>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/volcanoplot.py">This script</a> consists of a single function called <code class="docutils literal notranslate"><span class="pre">volcano</span></code> which takes the following inputs:</p>
<p><code class="docutils literal notranslate"><span class="pre">path_a=[path]</span></code> (required)<br />
<code class="docutils literal notranslate"><span class="pre">filelist_a=[list</span> <span class="pre">of</span> <span class="pre">pergene.txt</span> <span class="pre">filenames</span> <span class="pre">in</span> <span class="pre">path_a]</span></code> (required)<br />
<code class="docutils literal notranslate"><span class="pre">path_b=[path]</span></code> (required)<br />
<code class="docutils literal notranslate"><span class="pre">filelist_b=[list</span> <span class="pre">of</span> <span class="pre">pergene.txt</span> <span class="pre">filenames</span> <span class="pre">in</span> <span class="pre">path_b]</span></code> (required)<br />
<code class="docutils literal notranslate"><span class="pre">variable=&quot;read_per_gene&quot;||&quot;tn_per_gene&quot;||&quot;Nreadsperinsrt&quot;</span></code> (default=read_per_gene)<br />
<code class="docutils literal notranslate"><span class="pre">siginificance_threshold=[int]</span></code> (default=0.01)<br />
<code class="docutils literal notranslate"><span class="pre">normalize=True||False</span></code> (default=True)<br />
<code class="docutils literal notranslate"><span class="pre">trackgene_list=[list</span> <span class="pre">of</span> <span class="pre">gene</span> <span class="pre">names]</span></code><br />
<code class="docutils literal notranslate"><span class="pre">figure_title=[str]</span></code></p>
<p>A volcanoplot is useful to create to compare two strains with each other that each has multiple datasets (e.g. 2 wt strains and 4 mutant strains).
Therefore, the paths of the two datasets (<code class="docutils literal notranslate"><span class="pre">path_a</span></code> and <code class="docutils literal notranslate"><span class="pre">path_b</span></code>) are separated from the pergene.txt filenames, which should be given in a list (<code class="docutils literal notranslate"><span class="pre">filelist_a</span></code> and <code class="docutils literal notranslate"><span class="pre">filelist_b</span></code>).</p>
<p>It plots the fold change per gene vs the significance as determined by an independent t-test.
The fold change can be determined for the reads per gene (<code class="docutils literal notranslate"><span class="pre">variable=reads_per_gene</span></code>), insertions per gene (<code class="docutils literal notranslate"><span class="pre">variable=tn_per_gene</span></code>) or reads per inserions per gene (<code class="docutils literal notranslate"><span class="pre">variable=Nreadsperinsrt</span></code>).
The fold change is calculated by the log base 2 of the mean per gene for the experimental strain divided by the mean per gene for the reference strain (e.g. mean reads per gene mutant strain / mean reads per gene wt strain).</p>
<p>Before the mean is determined, the reads or insertions can be normalized by the total number of reads or insertions in each dataset.
This normalization can be skipped by setting <code class="docutils literal notranslate"><span class="pre">normalize=False</span></code>.</p>
<p>When the figure is created, the genes (each represented by a single dot) are colored depending on their significance.
The significance is determined using an independent t-test (calculated using <code class="docutils literal notranslate"><span class="pre">scipy.stats.ttest_ind()</span></code>) and it represented as the -log base 10.
This means that genes that are high up on the y-axis and far away from the 0 on the x-axis are the genes with a large and significant fold change.
When the significance of a gene is higher then the threshold set by <code class="docutils literal notranslate"><span class="pre">threshold</span></code>, then the genes are considered significant and are colored red, otherwise they are colored black.</p>
<p>Optionally, a list of genes can be given which are shown with a fixed label in the graph.
For this enter the gene names as a list in the <code class="docutils literal notranslate"><span class="pre">trackgene_list</span></code> variable and use the same names as they occur in the files.
The other genes can be found in the graph by hovering the cursor over each datapoint and then a label will appear that show the name of the gene that the datapoint is representing.
The title of the graph can be changed using the <code class="docutils literal notranslate"><span class="pre">figure_title</span></code> by entering a string that will be printed with the figure.
Next to the custom title, the title indicates what variable is plotted in the graph (i.e. reads per gene, insertions per gene or reads per insertion).</p>
<ul class="simple">
<li><p><strong>Output</strong></p></li>
</ul>
<p>The main output of the script is the interactive volcano plot of fold change vs significance.
Also it returns the variable <code class="docutils literal notranslate"><span class="pre">volcano_df</span></code> that includes the information used for plotting.
In the dataframe each row consists of a gene and the following columns are used:</p>
<ul class="simple">
<li><p>gene names</p></li>
<li><p>fold change</p></li>
<li><p>t statistic</p></li>
<li><p>p value</p></li>
<li><p>significance (True or False)</p></li>
</ul>
<a class="reference internal image-reference" href="mediavolcanoplot_figure.png"><img alt="volcanoplot_figure" src="mediavolcanoplot_figure.png" style="width: 700px;" /></a>
<ul class="simple">
<li><p><strong>Notes</strong></p></li>
<li><p>[ ] The fold change is calculated as the ratio between the means of the datasets. But this is an issue when either of the dataset is 0. To prevent this issue, for each gene in each dataset, 5 insertions and 25 reads are added. This ensures there is never a 0 in the division. This chosen because the processing of the Kornmann-lab also does this and by integrating the same method in this script allows for direct comparison of the figures. However, this is not completely fair as it changes the data. For example, if the initial number of insertions were 1 and 2 it yields a fold change of 0.5. By adding 5 insertions to it it becomes 6 and 7, respectively, yielding a fold change of 0.85.</p></li>
</ul>
</div>
<div class="section" id="create-essentialgenes-list-py">
<h4>create_essentialgenes_list.py<a class="headerlink" href="#create-essentialgenes-list-py" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><strong>Main tasks</strong></p></li>
</ul>
<p>Combine mulitple files with essential genes into one.</p>
<ul class="simple">
<li><p><strong>Dependencies</strong></p></li>
</ul>
<p><a class="reference external" href="#gene_namespy">gene_names.py</a></p>
<ul class="simple">
<li><p><strong>How and when to use</strong></p></li>
</ul>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/create_essentialgenes_list.py">This code</a> was initially created because there were multiple text files with essential genes for Cerevisiae.
However, none of the lists was complete and thus there were genes in one file that were not in the other and vice versa.
Also the files used different naming conventions.
This code takes a list of paths to multiple text files containing gene names.
It assumes there are three header lines in each text file (which can be empty) and after that each line contains a single name of a gene.</p>
<p>This code iterates over all files given in the input list and creates a new text file at the same location as the first occuring path in the input list and gives this new file the name <code class="docutils literal notranslate"><span class="pre">Cerevisiae_AllEssentialGenes_List.txt</span></code>.</p>
<p>It takes the gene names from each file and converts the names in the oln naming convention.
While iterating over all input files it searches if a gene already occurs in the newly created file.
If a gene already exists, it will be skipped to prevent the same genes are being stored multiple times.</p>
<p>The current <a class="reference external" href="#cerevisiae_allessentialgenes_listtxt">Cerevisiae_AllEssentialGenes_List.txt</a> file is created with this code.</p>
<ul class="simple">
<li><p><strong>Output</strong></p></li>
</ul>
<p>A text file is created that contains all known essential genes with the names <code class="docutils literal notranslate"><span class="pre">Cerevisiae_AllEssentialGenes_List.txt</span></code>.</p>
<ul class="simple">
<li><p><strong>Notes</strong></p></li>
<li><p>[ ] This code is hardly used, but it was needed when the creating the list of essential genes from multiple sources. It might be useful when either of the lists are updated or other lists are added.</p></li>
</ul>
</div>
</div>
<div class="section" id="python-modules">
<h3>python modules<a class="headerlink" href="#python-modules" title="Permalink to this headline">¶</a></h3>
<p>The python modules always contain functions that perform a certain task that is often required in multiple python scripts.
To use these python modules in a python script a path needs to be defined to the module.
This can be done best using relative paths stated at the very beginning of a script with the following lines:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">os,</span> <span class="pre">sys</span></code><br />
<code class="docutils literal notranslate"><span class="pre">file_dirname</span> <span class="pre">=</span> <span class="pre">os.path.dirname(os.path.abspath('__file__'))</span></code><br />
<code class="docutils literal notranslate"><span class="pre">sys.path.insert(1,os.path.join(file_dirname,'python_modules'))</span></code></p>
</div></blockquote>
<p>Then an import can be done as usual in the form</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">module_name</span> <span class="pre">import</span> <span class="pre">function</span></code></p>
</div></blockquote>
<p>For example to import the <code class="docutils literal notranslate"><span class="pre">chromosome_position</span></code> function from the <code class="docutils literal notranslate"><span class="pre">chromosome_and_gene_positions.py</span></code> module:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">chromosome_and_gene_positions</span> <span class="pre">import</span> <span class="pre">chromosome_position</span></code></p>
</div></blockquote>
<p>The output of these functions are given in the <code class="docutils literal notranslate"><span class="pre">return</span></code> statement.
If there are multiple outputs in the return statement, the function also expects multiple variables to assigned when calling this function in a python scripts (e.g. if function <code class="docutils literal notranslate"><span class="pre">f</span></code> has two outputs, call this the function as <code class="docutils literal notranslate"><span class="pre">var1,</span> <span class="pre">var2</span> <span class="pre">=</span> <span class="pre">f([inputs])</span></code> or <code class="docutils literal notranslate"><span class="pre">var1</span> <span class="pre">=</span> <span class="pre">f([inputs])[0]</span></code> if only <code class="docutils literal notranslate"><span class="pre">var1</span></code> is needed, where <code class="docutils literal notranslate"><span class="pre">[inputs]</span></code> are to be replaced with the input variable(s) (if any)).</p>
<div class="section" id="chromosome-and-gene-positions-py">
<h4>chromosome_and_gene_positions.py<a class="headerlink" href="#chromosome-and-gene-positions-py" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/python_modules/chromosome_and_gene_positions.py">This module</a> can be used for obtaining information regarding gene and chromosome positions and lengths and converting roman to arabic numerals for chromosomes.
It contains 3 functions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">chromosome_position</span></code></p></li>
</ul>
<p>This function outputs 3 dictionaries:</p>
<p><code class="docutils literal notranslate"><span class="pre">chr_start_pos_dict</span></code> which contains the start position of all chromosomes<br />
<code class="docutils literal notranslate"><span class="pre">chr_end_pos_dict</span></code> which contains the end position of all chromosomes<br />
<code class="docutils literal notranslate"><span class="pre">chr_length_dict</span></code> which contains the lenghts of all chromosomes</p>
<p>The input is a .gff3 file which, in case no output is given, is obtained from the data_files folder.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">chromosomename_roman_to_arabic</span></code></p></li>
</ul>
<p>This function outputs 2 dictionaries:</p>
<p><code class="docutils literal notranslate"><span class="pre">arabic_to_roman_dict</span></code> for which the keys are arabic numerals and the values are roman numerals<br />
<code class="docutils literal notranslate"><span class="pre">roman_to_arabic_dict</span></code> for which the keys are roman numerals and the values are arabic numerals</p>
<p>There is no input for this function.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gene_position</span></code></p></li>
</ul>
<p>This function outputs 1 dictionary:</p>
<p><code class="docutils literal notranslate"><span class="pre">gene_pos_dict</span></code></p>
<p>The keys in this dictionary are all gene names and each value is a list with the following information:</p>
<ol class="simple">
<li><p>Chromosome where the gene is positioned</p></li>
<li><p>Start basepair for the gene</p></li>
<li><p>End basepair for the gene</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">+</span></code> or <code class="docutils literal notranslate"><span class="pre">-</span></code> depending on whether it is on the forward or reverse strand.</p></li>
</ol>
<p>The input the path to a gff3 file which, if not provided, is taken from the data_files folder.</p>
<p>This module is also present as a python module in the python_transposonmapping folder for the processing workflow, although in a slightly altered version.</p>
</div>
<div class="section" id="chromosome-names-in-files-py">
<h4>chromosome_names_in_files.py<a class="headerlink" href="#chromosome-names-in-files-py" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/python_modules/chromosome_names_in_files.py">This module</a> extracts information about where the chromosomes start and end in a bed or wig file and gets the names of the chromosomes as used in these files.
It consists of 2 functions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">chromosome_name_bedfile</span></code></p></li>
</ul>
<p>This function outputs 3 dictionaries:</p>
<p><code class="docutils literal notranslate"><span class="pre">chrom_names_dict</span></code> which contains as keys roman numerals for the chromosome and the values are the chromosome names as are present in the bed file<br />
<code class="docutils literal notranslate"><span class="pre">chrom_start_line_dict</span></code> containing the lines where the chromosomes start in the bed file as values and the keys are roman numerals representing the chromosomes<br />
<code class="docutils literal notranslate"><span class="pre">chrom_end_line_dict</span></code> containing the lines where the chromosomes end in the bed file as values and the keys are roman numerals representing the chromosomes</p>
<p>This can be useful when only a specific chromosome is required, that not the entire file needs to be searched, but rather a range of lines in the bed and wig files can be read where the specified chromosome occurs.</p>
<p>The input of this function is a required path to a bed file.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">chromosome_name_wigfile</span></code></p></li>
</ul>
<p>This function is very similar as for the bed file, but altered to work specifically for the wig file and also outputs the same 3 dictionaries:</p>
<p><code class="docutils literal notranslate"><span class="pre">chrom_names_dict</span></code> which contains as keys roman numerals for the chromosome and the values are the chromosome names as are present in the wig file<br />
<code class="docutils literal notranslate"><span class="pre">chrom_start_line_dict</span></code> containing the lines where the chromosomes start in the wig file as values and the keys are roman numerals representing the chromosomes<br />
<code class="docutils literal notranslate"><span class="pre">chrom_end_line_dict</span></code> containing the lines where the chromosomes end in the wig file as values and the keys are roman numerals representing the chromosomes</p>
<p>The input of this function is a required path to a wig file.</p>
</div>
<div class="section" id="dataframe-from-pergene-py">
<h4>dataframe_from_pergene.py<a class="headerlink" href="#dataframe-from-pergene-py" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/python_modules/dataframe_from_pergene.py">This module</a> creates a dataframe with the number of insertions and reads per gene and can be seen as a stripped down version of the python script <a class="reference external" href="#genomicfeatures_dataframepy">genomicfeatures_dataframe.py</a>.
It contains a single function:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dataframe_from_pergenefile</span></code></p></li>
</ul>
<p>This requires as input a path to a pergene.txt file and outputs a pandas dataframe where each row contains a gene and has the following columns:</p>
<ol class="simple">
<li><p>gene names</p></li>
<li><p>gene essentiality</p></li>
<li><p>transposons per gene</p></li>
<li><p>read per gene</p></li>
<li><p>number of reads per insertion</p></li>
</ol>
<p>This dataframe is stored in <code class="docutils literal notranslate"><span class="pre">read_gene_df</span></code>.
The module has the following dependencies:</p>
<p>numpy<br />
pandas<br />
re<br />
<a class="reference external" href="#cerevisiae_allessentialgenes_listtxt">Cerevisiae_EssentialGenes_List_1.txt</a><br />
<a class="reference external" href="#cerevisiae_allessentialgenes_listtxt">Cerevisiae_EssentialGenes_List_2.txt</a></p>
</div>
<div class="section" id="essential-genes-names-py">
<h4>essential_genes_names.py<a class="headerlink" href="#essential-genes-names-py" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/python_modules/essential_genes_names.py">This module</a> creates a list with all known essential genes in different naming conventions.
It contains a single function:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list_known_essentials</span></code></p></li>
</ul>
<p>This inputs a lists of files with essential gene names.
If no input is given, the files are collected from the data_files folder.
It simply takes all genes from all input files and put those in one list.
This list is therefore likely to contain redundant genes with different naming conventions.
This list is stored in the variable <code class="docutils literal notranslate"><span class="pre">known_essential_gene_list</span></code> and is useful to check whether a gene is annotated as essential without having to worry about naming conventions.</p>
</div>
<div class="section" id="gene-names-py">
<h4>gene_names.py<a class="headerlink" href="#gene-names-py" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/python_modules/gene_names.py">This module</a> can be used for getting all gene names and their aliases.
It consists of two functions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list_gene_names</span></code></p></li>
</ul>
<p>This function outputs a list of all genes names including aliases.
It is not indicated which gene names refer the same gene, but rather this is a complete overview of all gene names that are known for yeast.
This can be used, for example, to check whether an inputted gene name exists or not by checking if the gene name occurs in this list.
The input of this function a Yeast_Protein_Names.txt file, which if not provided is taken from the data_files folder.
The output function is <code class="docutils literal notranslate"><span class="pre">gene_name_list</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gene_aliases</span></code></p></li>
</ul>
<p>This function the more extensive version of the first function and outputs 3 dictionaries:</p>
<p><code class="docutils literal notranslate"><span class="pre">aliases_designation_dict</span></code> which contains as keys the gene names in systematic naming convention and the values are lists containing all aliases in the standard naming convention<br />
<code class="docutils literal notranslate"><span class="pre">aliases_sgd_dict</span></code> which contains as keys the gene names in systematic naming convention and the values are the SGD ID (this can be used on <a class="reference external" href="https://www.yeastgenome.org/">yeastgenome.org</a>)<br />
<code class="docutils literal notranslate"><span class="pre">aliases_swissprot_dict</span></code> which contains as keys the gene names in systematic naming convention and the values are the swissprot ID (this can be used on <a class="reference external" href="https://www.uniprot.org/">uniprot.org</a>)</p>
<p>This function also inputs a Yeast_Protein_Names.txt file, which if not provided is taken from the data_files folder.</p>
<p>This module is also present as a python module in the python_transposonmapping folder for the processing workflow.</p>
</div>
<div class="section" id="mapped-reads-py">
<h4>mapped_reads.py<a class="headerlink" href="#mapped-reads-py" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/python_modules/mapped_reads.py">This module</a> can be used for counting the number of insertions and number of reads in a bed or wig file.
It consists of a single function:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">total_mapped_reads</span></code></p></li>
</ul>
<p>This function counts the number of lines in the bed or wig file (minus the header line and empty lines at the end) to get the number of insertions and sums the number of reads.
The output is a dictionary containing 3 elements:</p>
<p><code class="docutils literal notranslate"><span class="pre">Ninsertions</span></code> which represents the number of insertions<br />
<code class="docutils literal notranslate"><span class="pre">Nreads</span></code> representing the number of reads<br />
<code class="docutils literal notranslate"><span class="pre">Median</span></code> representing the median read count per insertion</p>
<p>The input is either a wig or a bed file and a verbose argument can be set to False to suppress any printing of the values.</p>
<p>Note that using a bed file is more accurate than using a wig file.
In the wig file the insertions that were mapped to the same location, but have a different orientation are summed.
This means that the number of reads should be the same as the number of reads found in the bed file, but the number of insertions can deviate depending how often reads with a different orientation are mapped to the same location.
See for more information see the section about the <a class="reference external" href="#wig">wig</a> file.</p>
<p>This module has the following dependencies: numpy</p>
</div>
<div class="section" id="read-sgdfeatures-py">
<h4>read_sgdfeatures.py<a class="headerlink" href="#read-sgdfeatures-py" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/python_modules/read_sgdfeatures.py">This module</a> creates dictionaries for many types of genomic features containing general information about these features.
It consists of a single function:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sgd_features</span></code></p></li>
</ul>
<p>This function reads the <a class="reference external" href="#sgd_featurestab">SGD_features.tab</a> file and extracts the following information:</p>
<ul class="simple">
<li><p>ORF (genes)</p></li>
<li><p>ARS</p></li>
<li><p>Telomere</p></li>
<li><p>long terminal repeat</p></li>
<li><p>Centromere</p></li>
<li><p>X element</p></li>
<li><p>Intron</p></li>
<li><p>ncRNA gene</p></li>
<li><p>Noncoding exon</p></li>
<li><p>tRNA gene</p></li>
<li><p>snoRNA gene</p></li>
<li><p>transposable element gene</p></li>
<li><p>five prime UTR intron</p></li>
<li><p>matrix attachment site</p></li>
<li><p>snRNA gene</p></li>
<li><p>rRNA gene</p></li>
<li><p>external transcribed spacer region</p></li>
<li><p>internal transcribed spacer region</p></li>
<li><p>origin of replication</p></li>
<li><p>telomerase RNA gene</p></li>
</ul>
<p>The function returns 20 dictionaries, one for each feature type, and it creates a list with the names of all feature types (called <code class="docutils literal notranslate"><span class="pre">genomicregions_list</span></code>).
In each dictionary the keys are the names of the features and the values consists of a single list with the following elements:</p>
<ul class="simple">
<li><p>feature type</p></li>
<li><p>feature qualifier (<code class="docutils literal notranslate"><span class="pre">Verified</span></code> or <code class="docutils literal notranslate"><span class="pre">Dubious</span></code>)</p></li>
<li><p>standard name</p></li>
<li><p>aliases (when more than one, separated by <code class="docutils literal notranslate"><span class="pre">|</span></code>)</p></li>
<li><p>parent feature name (typically ‘chromosome …’)</p></li>
<li><p>chromosome</p></li>
<li><p>start coordinate (starting at 0 for each chromosome)</p></li>
<li><p>end coordinate (starting at 0 for each chromosome)</p></li>
</ul>
<p>The input of the function is a path to the SGD_features.tab file and in case of no input, this file is taken from the data_files folder.</p>
</div>
<div class="section" id="samflag-py">
<h4><a class="reference external" href="http://samflag.py">samflag.py</a><a class="headerlink" href="#samflag-py" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/python_modules/samflag.py">This module</a> determines the parameters based on the alignment flag found in sam files.
It consists of single function:</p>
<p>-<code class="docutils literal notranslate"><span class="pre">samflag</span></code></p>
<p>This takes an integer as input and outputs a list of parameters corresponding to that integer.
This function executes the method described in the <a class="reference external" href="#sam-bam">sam, bam</a> section.
It converts the integer to a 12-bit binary number and each of the 12 bits correspond to an entry in a list of parameters.
The location of the ones (read from right to left) in the binary number determine which parameters are true given the input integer.</p>
<p>There are 2 outputs:</p>
<p><code class="docutils literal notranslate"><span class="pre">flag_binary</span></code> which returns the 12-bit binary sequence of the input integer<br />
<code class="docutils literal notranslate"><span class="pre">flagprop_list</span></code> which is a list containing all the parameters corresponding to the input integer.</p>
<p>This script is mainly used during the processing pipeline in the <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_transposonmapping/transposonmapping_satay.py">transposonmapping_satay.py</a> and therefore this module is also present as a python module in the python_transposonmapping folder.</p>
</div>
</div>
<div class="section" id="data-files">
<h3>Data files<a class="headerlink" href="#data-files" title="Permalink to this headline">¶</a></h3>
<div class="section" id="cerevisiae-allessentialgenes-list-txt">
<h4>Cerevisiae_AllEssentialGenes_List.txt<a class="headerlink" href="#cerevisiae-allessentialgenes-list-txt" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Cerevisiae_AllEssentialGenes_List.txt">This text file</a> contains all known annotated essential genes in wild type according to SGD.
It is created using <a class="reference external" href="#create_essentialgenes_listpy">create_essentialgenes_list.py</a> where the genes are taken from both <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Cerevisiae_EssentialGenes_List_1.txt">Cerevisiae_EssentialGenes_List_1.txt</a> and <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Cerevisiae_EssentialGenes_List_2.txt">Cerevisiae_EssentialGenes_List_2.txt</a>.
Both latter two files contain essential genes, but in different naming format and both contain genes not found in the other file.
The Cerevisiae_AllEssentialGenes_List.txt file is a combination of the two files with all genes from both files and is therefore the most complete version.
Each file contains a header with the source where the information is downloaded from.</p>
</div>
<div class="section" id="s288c-reference-sequence-r64-2-1-20150113-fsa">
<h4>S288C_reference_sequence_R64-2-1_20150113.fsa<a class="headerlink" href="#s288c-reference-sequence-r64-2-1-20150113-fsa" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/S288C_reference_sequence_R64-2-1_20150113.fsa">This fasta file</a> is the reference genome for yeast used for alignment and downloaded from <a class="reference external" href="http://sgd-archive.yeastgenome.org/sequence/S288C_reference/genome_releases/">yeastgenome.org</a>.
Note that before using a fasta file for alignment, the file has to be indexed.
This can be done in Linux using the command <code class="docutils literal notranslate"><span class="pre">bwa</span> <span class="pre">index</span> <span class="pre">[path]/S288C_reference_sequence_R64-2-1_20150113.fsa</span></code> where <code class="docutils literal notranslate"><span class="pre">[path]</span></code> is replaced with the path to the reference fasta file.</p>
</div>
<div class="section" id="sgd-features-tab">
<h4>SGD_features.tab<a class="headerlink" href="#sgd-features-tab" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/SGD_features.tab">This file</a> contains information for each genomic feature (e.g. genes, telomeres, centromers etc.) and was downloaded from <a class="reference external" href="http://sgd-archive.yeastgenome.org/?prefix=curation/chromosomal_feature/">SGD</a>.
It comes with a <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/SGD_features.README">readme</a> explaining the contents.</p>
</div>
<div class="section" id="saccharomyces-cerevisiae-r64-1-1-99-gff3">
<h4>Saccharomyces_cerevisiae.R64-1-1.99.gff3<a class="headerlink" href="#saccharomyces-cerevisiae-r64-1-1-99-gff3" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Saccharomyces_cerevisiae.R64-1-1.99.gff3">This file</a> contains all information about the genes.
The saccharomyces_cereivisae.gff.gz can be downloaded from <a class="reference external" href="http://sgd-archive.yeastgenome.org/?prefix=curation/chromosomal_feature/">SGD</a>.</p>
<p>Note, the current downloadable file is a newer version with a slightly updated format.
This is not integrated in the current python scripts, hence the old version is still used.</p>
</div>
<div class="section" id="yeast-protein-names-txt">
<h4>Yeast_Protein_Names.txt<a class="headerlink" href="#yeast-protein-names-txt" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/Yeast_Protein_Names.txt">This file</a> is downloaded from <a class="reference external" href="https://www.uniprot.org/docs/yeast">uniprot</a> and contains all known genes with all aliases and different naming conventions (i.e. designation, oln, swiss-prot and SGD cross-reference names).
This file can be used for searching different namings for genes, for example using <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/python_modules/gene_names.py">gene_names.py</a> or <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/genomicfeatures_dataframe.py">genomicfeatures_dataframe.py</a>.
This file is still regularly updated on <a class="reference external" href="https://www.uniprot.org/docs/yeast">uniprot</a>.</p>
<p>From this file, the files <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/S_Cerevisiae_protein_designation_name_full_genome.txt">S_Cerevisiae_protein_designation_name_full_genome.txt</a> and <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/data_files/S_Cerevisiae_protein_oln_name_full_genome.txt">S_Cerevisiae_protein_oln_name_full_genome.txt</a> are created using <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/blob/master/python_scripts/python_modules/gene_names.py">gene_names.py</a>, each containing all genes in a consistent naming convention.</p>
</div>
</div>
<div class="section" id="other-tools">
<h3>Other tools<a class="headerlink" href="#other-tools" title="Permalink to this headline">¶</a></h3>
<div class="section" id="igv">
<h4>IGV<a class="headerlink" href="#igv" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference external" href="https://software.broadinstitute.org/software/igv/">integrative Genomics Viewer</a> is a tool to visualize the mapped reads and can be used for manually checking the output.
When opening the tool for the first time, load a <a class="reference external" href="#s288c_reference_sequence_r64-2-1_20150113fsa">reference genome</a> by going to <code class="docutils literal notranslate"><span class="pre">Genomes</span></code> in the task bar, click <code class="docutils literal notranslate"><span class="pre">Load</span> <span class="pre">genome</span> <span class="pre">from</span> <span class="pre">file</span></code> and select the reference fasta.
Alternatively in the top bar, in the left most drop-down menu click <code class="docutils literal notranslate"><span class="pre">More...</span></code> and select the S. cerevisiae (sacCer3) genome (which comes standard with IGV).
Next, select <code class="docutils literal notranslate"><span class="pre">File</span></code> from the task bar and click <code class="docutils literal notranslate"><span class="pre">Load</span> <span class="pre">from</span> <span class="pre">file</span></code>.
Select a bam file which should have an index (.bam.bai) file stored at the same location.
In the top of the window check if the right reference genome is loaded and select a chromosome to view (in the drop-down menu that says ‘All’ or a chromosome name).
Zoom in to a region of interest which should then show all the reads present.
Hovering the cursor over a read should give more information about that read.
For example, this can be used to check the mapping quality of reads (MAPQ) and to check if the location of the reads correspond to the insertion locations stored in the output files from the workflow.</p>
</div>
<div class="section" id="genome-browser">
<h4>genome browser<a class="headerlink" href="#genome-browser" title="Permalink to this headline">¶</a></h4>
<p>Another useful tool the <a class="reference external" href="http://genome-euro.ucsc.edu/index.html">genome browser</a>, which is an online tool for showing alignment data together with a reference genome.
This also shows different features, for example where the genes are located.
To use this tool, go to <code class="docutils literal notranslate"><span class="pre">My</span> <span class="pre">Data</span></code> in the top bar and select <code class="docutils literal notranslate"><span class="pre">My</span> <span class="pre">Sessions</span></code>.
Here you should create an account if you haven’t done this before.
After this, go to the <code class="docutils literal notranslate"><span class="pre">Session</span> <span class="pre">Management</span></code> (on the same page) and at <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">Settings</span></code>, enter a name for your dataset at <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">current</span> <span class="pre">settings</span> <span class="pre">as</span> <span class="pre">named</span> <span class="pre">session</span></code>.
Optionally you can set the checkbox <code class="docutils literal notranslate"><span class="pre">allow</span> <span class="pre">this</span> <span class="pre">session</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">loaded</span> <span class="pre">by</span> <span class="pre">others</span></code> to give other people the possibility to see your data, but this is not required.
Press <code class="docutils literal notranslate"><span class="pre">Submit</span></code>.
While still on the same page, you should now see your dataset name in the section <code class="docutils literal notranslate"><span class="pre">My</span> <span class="pre">Sessions</span></code>.
Click the name to open the browser.
Here you should see an interactive figure with some default tracks.
It may happen that not the right organism is selected (e.g. by default the Human genome is loaded), this will be resolved in the next step.
Right below the browser, there are some functions for the browser.
Click here the <code class="docutils literal notranslate"><span class="pre">add</span> <span class="pre">custom</span> <span class="pre">tracks</span></code> option.
This should load a new page where you can select the right genome and add you own data.
For loading the genome, select the <code class="docutils literal notranslate"><span class="pre">Other</span></code> in the drop-down menu next to <code class="docutils literal notranslate"><span class="pre">clade</span></code> on the top of the page.
Then, select <code class="docutils literal notranslate"><span class="pre">S.</span> <span class="pre">cerevisiae</span></code> next to <code class="docutils literal notranslate"><span class="pre">genome</span></code> and then select the assembly <code class="docutils literal notranslate"><span class="pre">Apr.</span> <span class="pre">2011</span></code>.
On the same page, upload a bed or wig file next to <code class="docutils literal notranslate"><span class="pre">Paste</span> <span class="pre">URLs</span> <span class="pre">or</span> <span class="pre">data</span></code>.
Note that for this the bed or wig files need to be cleaned using <a class="reference external" href="#clean_bedwigfilespy">clean_bedwigfiles.py</a>.
Press <code class="docutils literal notranslate"><span class="pre">Submit</span></code> and after loading, press <code class="docutils literal notranslate"><span class="pre">Go</span></code> or add another track.
This should now show you again the browser, but now with the right genome and your track(s) loaded.
Note that by default the browser is zoomed in quite far, so you may want to zoom out somewhat or select a region or gene in the search bar.</p>
<p>This now allows you to see the insertions against all genomic features in the genome.
Your tracks are saved automatically and when the <code class="docutils literal notranslate"><span class="pre">allow</span> <span class="pre">this</span> <span class="pre">session</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">loaded</span> <span class="pre">by</span> <span class="pre">others</span></code> was selected, it can be shared with others.</p>
</div>
</div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The workflow discussed in this documentation processes the data from raw sequencing data to a list of insertions sites and read counts.
Here a summary is given of the most important steps to take starting after retrieving the sequencing data.</p>
<ol class="simple">
<li><p>Manually check the fastq files to see if the reads appear to be ok and if you can recognise adapter, primer or transposon sequences (if any) that need to be trimmed.</p></li>
<li><p>If needed, preprocess the data. For example demultiplexing when multiple samples were sequenced simultaneously. Store the data for each sample in individual fastq files, preferably as single-end reads.</p></li>
<li><p>Input the (preprocessed) fastq files in the workflow. For this, store the fastq files on the Linux desktop and run the workflow using the command <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">satay.sh</span></code> (located in the software folder).</p></li>
<li><p>When it is the first time processing the data, it is advised to set the <code class="docutils literal notranslate"><span class="pre">Quality</span> <span class="pre">checking</span> <span class="pre">raw</span> <span class="pre">data</span></code> and <code class="docutils literal notranslate"><span class="pre">Quality</span> <span class="pre">check</span> <span class="pre">interrupt</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>. This allows you to check the quality of the raw fastq files before the actual processing starts and to spot any artefacts or unwanted (overrepresented) sequences.</p></li>
<li><p>Run the processing workflow with trimming settings and alignment settings that suits the data. Determining the right settings is not always straightforward and often require some trial and error. It is advised to always trim away the unwanted sequences (e.g. adapter, primer and transposon sequences or overrepresented sequences found by the raw quality check) by copying those sequences to the adapters file. It is good to do some quality trimming for the last basepairs of each read as well (see quality report of the raw data how many basepairs would be needed, if any). For the alignment it is advised to set the settings a little more stringent compared with the default values (see <a class="reference external" href="http://bio-bwa.sourceforge.net/bwa.shtml">the BWA MEM manual</a>), but not too stringent as this can have a negative impact on the alignment.</p></li>
<li><p>After processing, check the output of each function to see how many reads were trimmed and aligned. If many cells were removed after trimming or when many reads were not aligned, you may have set some options too stringent. Also check the quality report of the trimmed reads and compare this with the quality report for the raw reads. Any overrepresented sequences that were entered in the adapters file are expected to be gone and the overall quality should have improved when trimming low quality basepairs was set.</p></li>
<li><p>When the processing is finished and the quality report and outputs all seem reasonable, check the resulting output files (i.e. bed, wig and multiple text files, see the <a class="reference external" href="#input-output">Input, Output</a> section). Preferably, run the bed and wig files in the <a class="reference external" href="#clean_bedwigfilespy">clean_bedwigfiles.py</a> to remove any insertions mapped outside the chromosomes. Run the <a class="reference external" href="#transposonread_profileplot_genomepy">transposonread_profileplot_genome.py</a> script to check if the overall coverage of the insertions in the genome is good. There should be no large empty regions or large peaks, except for those around the centromeres of each chromosome, one large peak near the middle of chromosome 12 and a peak at the Ade2 gene in chromosome 15.</p></li>
<li><p>Next check the individual chromosomes using <a class="reference external" href="#transposonread_profileplotpy">transposonread_profileplot.py</a>. This generates similar figures as transposonread_profileplot.py, but this is on chromosome level and allows to check if the annotated essential gene have significant less insertions compared to the other regions. To check the distribution of reads per gene and compare this between essential and non-essential genes, the <a class="reference external" href="#scatterplot_genespy">scatterplot_genes.py</a> script can be used.</p></li>
<li><p>When processing a mutant strain, also check if the deleted gene(s) are devoid of insertions as well. For this the pergene.txt file can be used or the gene can be checked in <a class="reference external" href="#igv">IGV</a> or the <a class="reference external" href="#genome-browser">genome browser</a>.</p></li>
<li><p>For further analysis, the <a class="reference external" href="#genomicfeatures_dataframepy">genomicfeatures_dataframe.py</a> function can be used that contains the most important information from the processing files. This function can be integrated in other python scripts.</p></li>
</ol>
</div>
<div class="section" id="links">
<h2>Links<a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h2>
<p>Github page: <a class="reference external" href="https://github.com/leilaicruz/LaanLab-SATAY-DataAnalysis">github.com/leilaicruz/LaanLab-SATAY-DataAnalysis/tree/satay_processing</a></p>
<p>Jupyter notebook about this project: <a class="reference external" href="https://leilaicruz.github.io/SATAY-jupyter-book/Introduction.html">leilaicruz.github.io/SATAY-jupyter-book/Introduction.html</a></p>
<p>Laanlab: <a class="reference external" href="https://www.tudelft.nl/en/faculty-of-applied-sciences/about-faculty/departments/bionanoscience/research/research-labs/liedewij-laan-lab/research-projects/evolvability-and-modularity-of-essential-functions-in-budding-yeast">tudelft.nl/laanlab</a></p>
<p>Satay website: <a class="reference external" href="https://sites.google.com/site/satayusers/">sites.google.com/site/satayusers/</a></p>
<p>Satay forum: <a class="reference external" href="https://groups.google.com/g/satayusers">groups.google.com/g/satayusers</a></p>
<p>eLife paper satay: <a class="reference external" href="https://elifesciences.org/articles/23570#content">elifesciences.org/articles/23570#content</a></p>
<p>Yeast genome: <a class="reference external" href="https://www.yeastgenome.org/">yeastgenome.org/</a></p>
<p>Yeast mine: <a class="reference external" href="https://yeastmine.yeastgenome.org/yeastmine/begin.do">yeastmine.yeastgenome.org/yeastmine/begin.do</a></p>
<p>Datacarpentry course about genomics (also contains a course in using the Linux bash and command line tools): <a class="reference external" href="https://datacarpentry.org/lessons/#genomics-workshop">datacarpentry.org/lessons/#genomics-workshop</a></p>
</div>
<div class="section" id="appendices">
<h2>Appendices<a class="headerlink" href="#appendices" title="Permalink to this headline">¶</a></h2>
<div class="section" id="phred-table-base33">
<h3>PHRED table (base33)<a class="headerlink" href="#phred-table-base33" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>ASCII symbol</p></th>
<th class="head"><p>ASCII value</p></th>
<th class="head"><p>Q</p></th>
<th class="head"><p>P_err</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>!</p></td>
<td><p>33</p></td>
<td><p>0</p></td>
<td><p>1,000000</p></td>
</tr>
<tr class="row-odd"><td><p>“</p></td>
<td><p>34</p></td>
<td><p>1</p></td>
<td><p>0,794328</p></td>
</tr>
<tr class="row-even"><td><p>#</p></td>
<td><p>35</p></td>
<td><p>2</p></td>
<td><p>0,630957</p></td>
</tr>
<tr class="row-odd"><td><p>$</p></td>
<td><p>36</p></td>
<td><p>3</p></td>
<td><p>0,501187</p></td>
</tr>
<tr class="row-even"><td><p>%</p></td>
<td><p>37</p></td>
<td><p>4</p></td>
<td><p>0,398107</p></td>
</tr>
<tr class="row-odd"><td><p>&amp;</p></td>
<td><p>38</p></td>
<td><p>5</p></td>
<td><p>0,316228</p></td>
</tr>
<tr class="row-even"><td><p>’</p></td>
<td><p>39</p></td>
<td><p>6</p></td>
<td><p>0,251189</p></td>
</tr>
<tr class="row-odd"><td><p>(</p></td>
<td><p>40</p></td>
<td><p>7</p></td>
<td><p>0,199526</p></td>
</tr>
<tr class="row-even"><td><p>)</p></td>
<td><p>41</p></td>
<td><p>8</p></td>
<td><p>0,158489</p></td>
</tr>
<tr class="row-odd"><td><p>*</p></td>
<td><p>42</p></td>
<td><p>9</p></td>
<td><p>0,125893</p></td>
</tr>
<tr class="row-even"><td><p>+</p></td>
<td><p>43</p></td>
<td><p>10</p></td>
<td><p>0,100000</p></td>
</tr>
<tr class="row-odd"><td><p>,</p></td>
<td><p>44</p></td>
<td><p>11</p></td>
<td><p>0,079433</p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p>45</p></td>
<td><p>12</p></td>
<td><p>0,063096</p></td>
</tr>
<tr class="row-odd"><td><p>.</p></td>
<td><p>46</p></td>
<td><p>13</p></td>
<td><p>0,050119</p></td>
</tr>
<tr class="row-even"><td><p>/</p></td>
<td><p>47</p></td>
<td><p>14</p></td>
<td><p>0,039811</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>48</p></td>
<td><p>15</p></td>
<td><p>0,031623</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>49</p></td>
<td><p>16</p></td>
<td><p>0,025119</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>50</p></td>
<td><p>17</p></td>
<td><p>0,019953</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>51</p></td>
<td><p>18</p></td>
<td><p>0,015849</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>52</p></td>
<td><p>19</p></td>
<td><p>0,012589</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>53</p></td>
<td><p>20</p></td>
<td><p>0,010000</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>54</p></td>
<td><p>21</p></td>
<td><p>0,007943</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>55</p></td>
<td><p>22</p></td>
<td><p>0,006310</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>56</p></td>
<td><p>23</p></td>
<td><p>0,005012</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>57</p></td>
<td><p>24</p></td>
<td><p>0,003981</p></td>
</tr>
<tr class="row-odd"><td><p>:</p></td>
<td><p>58</p></td>
<td><p>25</p></td>
<td><p>0,003162</p></td>
</tr>
<tr class="row-even"><td><p>;</p></td>
<td><p>59</p></td>
<td><p>26</p></td>
<td><p>0,002512</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;</p></td>
<td><p>60</p></td>
<td><p>27</p></td>
<td><p>0,001995</p></td>
</tr>
<tr class="row-even"><td><p>=</p></td>
<td><p>61</p></td>
<td><p>28</p></td>
<td><p>0,001585</p></td>
</tr>
<tr class="row-odd"><td><p>&gt;</p></td>
<td><p>62</p></td>
<td><p>29</p></td>
<td><p>0,001259</p></td>
</tr>
<tr class="row-even"><td><p>?</p></td>
<td><p>63</p></td>
<td><p>30</p></td>
<td><p>0,001000</p></td>
</tr>
<tr class="row-odd"><td><p>&#64;</p></td>
<td><p>64</p></td>
<td><p>31</p></td>
<td><p>0,000794</p></td>
</tr>
<tr class="row-even"><td><p>A</p></td>
<td><p>65</p></td>
<td><p>32</p></td>
<td><p>0,000631</p></td>
</tr>
<tr class="row-odd"><td><p>B</p></td>
<td><p>66</p></td>
<td><p>33</p></td>
<td><p>0,000501</p></td>
</tr>
<tr class="row-even"><td><p>C</p></td>
<td><p>67</p></td>
<td><p>34</p></td>
<td><p>0,000398</p></td>
</tr>
<tr class="row-odd"><td><p>D</p></td>
<td><p>68</p></td>
<td><p>35</p></td>
<td><p>0,000316</p></td>
</tr>
<tr class="row-even"><td><p>E</p></td>
<td><p>69</p></td>
<td><p>36</p></td>
<td><p>0,000251</p></td>
</tr>
<tr class="row-odd"><td><p>F</p></td>
<td><p>70</p></td>
<td><p>37</p></td>
<td><p>0,000200</p></td>
</tr>
<tr class="row-even"><td><p>G</p></td>
<td><p>71</p></td>
<td><p>38</p></td>
<td><p>0,000158</p></td>
</tr>
<tr class="row-odd"><td><p>H</p></td>
<td><p>72</p></td>
<td><p>39</p></td>
<td><p>0,000126</p></td>
</tr>
<tr class="row-even"><td><p>I</p></td>
<td><p>73</p></td>
<td><p>40</p></td>
<td><p>0,000100</p></td>
</tr>
<tr class="row-odd"><td><p>J</p></td>
<td><p>74</p></td>
<td><p>41</p></td>
<td><p>0,000079</p></td>
</tr>
<tr class="row-even"><td><p>K</p></td>
<td><p>75</p></td>
<td><p>42</p></td>
<td><p>0,000063</p></td>
</tr>
<tr class="row-odd"><td><p>L</p></td>
<td><p>76</p></td>
<td><p>43</p></td>
<td><p>0,000050</p></td>
</tr>
<tr class="row-even"><td><p>M</p></td>
<td><p>77</p></td>
<td><p>44</p></td>
<td><p>0,000040</p></td>
</tr>
<tr class="row-odd"><td><p>N</p></td>
<td><p>78</p></td>
<td><p>45</p></td>
<td><p>0,000032</p></td>
</tr>
<tr class="row-even"><td><p>O</p></td>
<td><p>79</p></td>
<td><p>46</p></td>
<td><p>0,000025</p></td>
</tr>
<tr class="row-odd"><td><p>P</p></td>
<td><p>80</p></td>
<td><p>47</p></td>
<td><p>0,000020</p></td>
</tr>
<tr class="row-even"><td><p>Q</p></td>
<td><p>81</p></td>
<td><p>48</p></td>
<td><p>0,000016</p></td>
</tr>
<tr class="row-odd"><td><p>R</p></td>
<td><p>82</p></td>
<td><p>49</p></td>
<td><p>0,000013</p></td>
</tr>
<tr class="row-even"><td><p>S</p></td>
<td><p>83</p></td>
<td><p>50</p></td>
<td><p>0,000010</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="phred-table-base64">
<h3>PHRED table (base64)<a class="headerlink" href="#phred-table-base64" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>ASCII symbol</p></th>
<th class="head"><p>ASCII value</p></th>
<th class="head"><p>Q</p></th>
<th class="head"><p>P_err</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>&#64;</p></td>
<td><p>64</p></td>
<td><p>0</p></td>
<td><p>1,000000</p></td>
</tr>
<tr class="row-odd"><td><p>A</p></td>
<td><p>65</p></td>
<td><p>1</p></td>
<td><p>0,794328</p></td>
</tr>
<tr class="row-even"><td><p>B</p></td>
<td><p>66</p></td>
<td><p>2</p></td>
<td><p>0,630957</p></td>
</tr>
<tr class="row-odd"><td><p>C</p></td>
<td><p>67</p></td>
<td><p>3</p></td>
<td><p>0,501187</p></td>
</tr>
<tr class="row-even"><td><p>D</p></td>
<td><p>68</p></td>
<td><p>4</p></td>
<td><p>0,398107</p></td>
</tr>
<tr class="row-odd"><td><p>E</p></td>
<td><p>69</p></td>
<td><p>5</p></td>
<td><p>0,316228</p></td>
</tr>
<tr class="row-even"><td><p>F</p></td>
<td><p>70</p></td>
<td><p>6</p></td>
<td><p>0,251189</p></td>
</tr>
<tr class="row-odd"><td><p>G</p></td>
<td><p>71</p></td>
<td><p>7</p></td>
<td><p>0,199526</p></td>
</tr>
<tr class="row-even"><td><p>H</p></td>
<td><p>72</p></td>
<td><p>8</p></td>
<td><p>0,158489</p></td>
</tr>
<tr class="row-odd"><td><p>I</p></td>
<td><p>73</p></td>
<td><p>9</p></td>
<td><p>0,125893</p></td>
</tr>
<tr class="row-even"><td><p>J</p></td>
<td><p>74</p></td>
<td><p>10</p></td>
<td><p>0,100000</p></td>
</tr>
<tr class="row-odd"><td><p>K</p></td>
<td><p>75</p></td>
<td><p>11</p></td>
<td><p>0,079433</p></td>
</tr>
<tr class="row-even"><td><p>L</p></td>
<td><p>76</p></td>
<td><p>12</p></td>
<td><p>0,063096</p></td>
</tr>
<tr class="row-odd"><td><p>M</p></td>
<td><p>77</p></td>
<td><p>13</p></td>
<td><p>0,050119</p></td>
</tr>
<tr class="row-even"><td><p>N</p></td>
<td><p>78</p></td>
<td><p>14</p></td>
<td><p>0,039811</p></td>
</tr>
<tr class="row-odd"><td><p>O</p></td>
<td><p>79</p></td>
<td><p>15</p></td>
<td><p>0,031623</p></td>
</tr>
<tr class="row-even"><td><p>P</p></td>
<td><p>80</p></td>
<td><p>16</p></td>
<td><p>0,025119</p></td>
</tr>
<tr class="row-odd"><td><p>Q</p></td>
<td><p>81</p></td>
<td><p>17</p></td>
<td><p>0,019953</p></td>
</tr>
<tr class="row-even"><td><p>R</p></td>
<td><p>82</p></td>
<td><p>18</p></td>
<td><p>0,015849</p></td>
</tr>
<tr class="row-odd"><td><p>S</p></td>
<td><p>83</p></td>
<td><p>19</p></td>
<td><p>0,012589</p></td>
</tr>
<tr class="row-even"><td><p>T</p></td>
<td><p>84</p></td>
<td><p>20</p></td>
<td><p>0,010000</p></td>
</tr>
<tr class="row-odd"><td><p>U</p></td>
<td><p>85</p></td>
<td><p>21</p></td>
<td><p>0,007943</p></td>
</tr>
<tr class="row-even"><td><p>V</p></td>
<td><p>86</p></td>
<td><p>22</p></td>
<td><p>0,006310</p></td>
</tr>
<tr class="row-odd"><td><p>W</p></td>
<td><p>87</p></td>
<td><p>23</p></td>
<td><p>0,005012</p></td>
</tr>
<tr class="row-even"><td><p>X</p></td>
<td><p>88</p></td>
<td><p>24</p></td>
<td><p>0,003981</p></td>
</tr>
<tr class="row-odd"><td><p>Y</p></td>
<td><p>89</p></td>
<td><p>25</p></td>
<td><p>0,003162</p></td>
</tr>
<tr class="row-even"><td><p>Z</p></td>
<td><p>90</p></td>
<td><p>26</p></td>
<td><p>0,002512</p></td>
</tr>
<tr class="row-odd"><td><p>[</p></td>
<td><p>91</p></td>
<td><p>27</p></td>
<td><p>0,001995</p></td>
</tr>
<tr class="row-even"><td><p>\</p></td>
<td><p>92</p></td>
<td><p>28</p></td>
<td><p>0,001585</p></td>
</tr>
<tr class="row-odd"><td><p>]</p></td>
<td><p>93</p></td>
<td><p>29</p></td>
<td><p>0,001259</p></td>
</tr>
<tr class="row-even"><td><p>^</p></td>
<td><p>94</p></td>
<td><p>30</p></td>
<td><p>0,001000</p></td>
</tr>
<tr class="row-odd"><td><p>_</p></td>
<td><p>95</p></td>
<td><p>31</p></td>
<td><p>0,000794</p></td>
</tr>
<tr class="row-even"><td><p>`</p></td>
<td><p>96</p></td>
<td><p>32</p></td>
<td><p>0,000631</p></td>
</tr>
<tr class="row-odd"><td><p>a</p></td>
<td><p>97</p></td>
<td><p>33</p></td>
<td><p>0,000501</p></td>
</tr>
<tr class="row-even"><td><p>b</p></td>
<td><p>98</p></td>
<td><p>34</p></td>
<td><p>0,000398</p></td>
</tr>
<tr class="row-odd"><td><p>c</p></td>
<td><p>99</p></td>
<td><p>35</p></td>
<td><p>0,000316</p></td>
</tr>
<tr class="row-even"><td><p>d</p></td>
<td><p>100</p></td>
<td><p>36</p></td>
<td><p>0,000251</p></td>
</tr>
<tr class="row-odd"><td><p>e</p></td>
<td><p>101</p></td>
<td><p>37</p></td>
<td><p>0,000200</p></td>
</tr>
<tr class="row-even"><td><p>f</p></td>
<td><p>102</p></td>
<td><p>38</p></td>
<td><p>0,000158</p></td>
</tr>
<tr class="row-odd"><td><p>g</p></td>
<td><p>103</p></td>
<td><p>39</p></td>
<td><p>0,000126</p></td>
</tr>
<tr class="row-even"><td><p>h</p></td>
<td><p>104</p></td>
<td><p>40</p></td>
<td><p>0,000100</p></td>
</tr>
<tr class="row-odd"><td><p>i</p></td>
<td><p>105</p></td>
<td><p>41</p></td>
<td><p>0,000079</p></td>
</tr>
<tr class="row-even"><td><p>j</p></td>
<td><p>106</p></td>
<td><p>42</p></td>
<td><p>0,000063</p></td>
</tr>
<tr class="row-odd"><td><p>k</p></td>
<td><p>107</p></td>
<td><p>43</p></td>
<td><p>0,000050</p></td>
</tr>
<tr class="row-even"><td><p>l</p></td>
<td><p>108</p></td>
<td><p>44</p></td>
<td><p>0,000040</p></td>
</tr>
<tr class="row-odd"><td><p>m</p></td>
<td><p>109</p></td>
<td><p>45</p></td>
<td><p>0,000032</p></td>
</tr>
<tr class="row-even"><td><p>n</p></td>
<td><p>110</p></td>
<td><p>46</p></td>
<td><p>0,000025</p></td>
</tr>
<tr class="row-odd"><td><p>o</p></td>
<td><p>111</p></td>
<td><p>47</p></td>
<td><p>0,000020</p></td>
</tr>
<tr class="row-even"><td><p>p</p></td>
<td><p>112</p></td>
<td><p>48</p></td>
<td><p>0,000016</p></td>
</tr>
<tr class="row-odd"><td><p>q</p></td>
<td><p>113</p></td>
<td><p>49</p></td>
<td><p>0,000013</p></td>
</tr>
<tr class="row-even"><td><p>r</p></td>
<td><p>114</p></td>
<td><p>50</p></td>
<td><p>0,000010</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p><em>“I want to be a healer, and love all things that grow and are not barren”</em> - J.R.R. Tolkien</p>
</div></blockquote>
</div>
</div>
<div class="toctree-wrapper compound">
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='right-next' id="next-link" href="Introduction.html" title="next page">Status of the project</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Gregory van Beek , Maurits Kok, Leila Iñigo de la Cruz<br/>
        
            &copy; Copyright Apache 2.0.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>